from direct_summarizer.delivery.Delivery import Delivery
from snowpark_common_library.utils.utils import deep_get as get_dict_element
import snowflake.snowpark.functions as F
from snowflake.snowpark.types import IntegerType
from functools import partial

all_col_names = [
                "delivery_data_representation_id",
                "delivery_wid",
                "line_item_lineage_id",
                "pinterest_ad_group_wid",
                "delivered_on_date",
                "integration_source_code",
                "agency_id",
                "pinterest_campaign_wid",
                "pinterest_account_id",
                "pinterest_ad_group_id",
                "pinterest_advertiser_id",
                "pinterest_campaign_id",
                "pinterest_order_line_id",
                "ad_group_status",
                "campaign_managed_status",
                "src_campaign_lifetime_spend_cap",
                "src_campaign_daily_spend_cap",
                "src_clickthrough_1",
                "src_clickthrough_1_gross",
                "src_clickthrough_2",
                "src_engagement_1",
                "src_engagement_2",
                "src_idea_pin_product_tag_visit_1",
                "src_idea_pin_product_tag_visit_2",
                "src_impression_1",
                "src_impression_1_gross",
                "src_impression_2",
                "src_leads",
                "src_onsite_checkouts_1",
                "order_line_name",
                "src_outbound_click_1",
                "src_outbound_click_2",
                "src_paid_impression",
                "src_quiz_completed",
                "src_repin_1",
                "src_repin_2",
                "src_showcase_average_subpage_closeup_per_session",
                "src_showcase_card_thumbnail_swipe_backward",
                "src_showcase_card_thumbnail_swipe_forward",
                "src_showcase_pin_clickthrough",
                "src_showcase_subpage_clickthrough",
                "src_showcase_subpage_closeup",
                "src_showcase_subpage_impression",
                "src_showcase_subpage_repin",
                "src_showcase_subpage_swipe_left",
                "src_showcase_subpage_swipe_right",
                "src_showcase_subpin_clickthrough",
                "src_showcase_subpin_impression",
                "src_showcase_subpin_repin",
                "src_showcase_subpin_swipe_left",
                "src_showcase_subpin_swipe_right",
                "src_spend_in_dollar",
                "src_spend_in_micro_dollar",
                "src_total_add_to_cart",
                "src_total_add_to_cart_desktop_action_to_desktop_conversion",
                "src_total_add_to_cart_desktop_action_to_mobile_conversion",
                "src_total_add_to_cart_desktop_action_to_tablet_conversion",
                "src_total_add_to_cart_mobile_action_to_desktop_conversion",
                "src_total_add_to_cart_mobile_action_to_mobile_conversion",
                "src_total_add_to_cart_mobile_action_to_tablet_conversion",
                "src_total_add_to_cart_tablet_action_to_desktop_conversion",
                "src_total_add_to_cart_tablet_action_to_mobile_conversion",
                "src_total_add_to_cart_tablet_action_to_tablet_conversion",
                "src_total_add_to_cart_value_in_micro_dollar",
                "src_total_app_install",
                "src_total_app_install_desktop_action_to_desktop_conversion",
                "src_total_app_install_desktop_action_to_mobile_conversion",
                "src_total_app_install_desktop_action_to_tablet_conversion",
                "src_total_app_install_mobile_action_to_desktop_conversion",
                "src_total_app_install_mobile_action_to_mobile_conversion",
                "src_total_app_install_mobile_action_to_tablet_conversion",
                "src_total_app_install_tablet_action_to_desktop_conversion",
                "src_total_app_install_tablet_action_to_mobile_conversion",
                "src_total_app_install_tablet_action_to_tablet_conversion",
                "src_total_app_install_value_in_micro_dollar",
                "src_total_checkout",
                "src_total_checkout_desktop_action_to_desktop_conversion",
                "src_total_checkout_desktop_action_to_mobile_conversion",
                "src_total_checkout_desktop_action_to_tablet_conversion",
                "src_total_checkout_mobile_action_to_desktop_conversion",
                "src_total_checkout_mobile_action_to_mobile_conversion",
                "src_total_checkout_mobile_action_to_tablet_conversion",
                "src_total_checkout_quantity",
                "src_total_checkout_tablet_action_to_desktop_conversion",
                "src_total_checkout_tablet_action_to_mobile_conversion",
                "src_total_checkout_tablet_action_to_tablet_conversion",
                "src_total_checkout_value_in_micro_dollar",
                "src_total_click_add_to_cart",
                "src_total_click_add_to_cart_quantity",
                "src_total_click_add_to_cart_value_in_micro_dollar",
                "src_total_click_app_install",
                "src_total_click_app_install_value_in_micro_dollar",
                "src_total_click_checkout",
                "src_total_click_checkout_quantity",
                "src_total_click_checkout_value_in_micro_dollar",
                "src_total_click_custom",
                "src_total_click_custom_quantity",
                "src_total_click_custom_value_in_micro_dollar",
                "src_total_click_lead",
                "src_total_click_lead_quantity",
                "src_total_click_lead_value_in_micro_dollar",
                "src_total_click_page_visit",
                "src_total_click_page_visit_quantity",
                "src_total_click_page_visit_value_in_micro_dollar",
                "src_total_click_search",
                "src_total_click_search_quantity",
                "src_total_click_search_value_in_micro_dollar",
                "src_total_click_signup",
                "src_total_click_signup_quantity",
                "src_total_click_signup_value_in_micro_dollar",
                "src_total_clickthrough",
                "src_total_click_unknown",
                "src_total_click_unknown_quantity",
                "src_total_click_unknown_value_in_micro_dollar",
                "src_total_click_view_category",
                "src_total_click_view_category_quantity",
                "src_total_click_view_category_value_in_micro_dollar",
                "src_total_click_watch_video",
                "src_total_click_watch_video_quantity",
                "src_total_click_watch_video_value_in_micro_dollar",
                "src_total_conversions",
                "src_total_conversions_quantity",
                "src_total_conversions_value_in_micro_dollar",
                "src_total_custom",
                "src_total_custom_desktop_action_to_desktop_conversion",
                "src_total_custom_desktop_action_to_mobile_conversion",
                "src_total_custom_desktop_action_to_tablet_conversion",
                "src_total_custom_mobile_action_to_desktop_conversion",
                "src_total_custom_mobile_action_to_mobile_conversion",
                "src_total_custom_mobile_action_to_tablet_conversion",
                "src_total_custom_tablet_action_to_desktop_conversion",
                "src_total_custom_tablet_action_to_mobile_conversion",
                "src_total_custom_tablet_action_to_tablet_conversion",
                "src_total_custom_value_in_micro_dollar",
                "src_total_destination_views",
                "src_total_engagement",
                "src_total_engagement_add_to_cart",
                "src_total_engagement_add_to_cart_quantity",
                "src_total_engagement_add_to_cart_value_in_micro_dollar",
                "src_total_engagement_app_install",
                "src_total_engagement_app_install_value_in_micro_dollar",
                "src_total_engagement_checkout",
                "src_total_engagement_checkout_quantity",
                "src_total_engagement_checkout_value_in_micro_dollar",
                "src_total_engagement_custom",
                "src_total_engagement_custom_quantity",
                "src_total_engagement_custom_value_in_micro_dollar",
                "src_total_engagement_lead",
                "src_total_engagement_lead_quantity",
                "src_total_engagement_lead_value_in_micro_dollar",
                "src_total_engagement_page_visit",
                "src_total_engagement_page_visit_quantity",
                "src_total_engagement_page_visit_value_in_micro_dollar",
                "src_total_engagement_search",
                "src_total_engagement_search_quantity",
                "src_total_engagement_search_value_in_micro_dollar",
                "src_total_engagement_signup",
                "src_total_engagement_signup_quantity",
                "src_total_engagement_signup_value_in_micro_dollar",
                "src_total_engagement_unknown",
                "src_total_engagement_unknown_quantity",
                "src_total_engagement_unknown_value_in_micro_dollar",
                "src_total_engagement_view_category",
                "src_total_engagement_view_category_quantity",
                "src_total_engagement_view_category_value_in_micro_dollar",
                "src_total_engagement_watch_video",
                "src_total_engagement_watch_video_quantity",
                "src_total_engagement_watch_video_value_in_micro_dollar",
                "src_total_idea_pin_product_tag_visit",
                "src_total_impression",
                "src_total_inapp_add_to_cart",
                "src_total_inapp_add_to_cart_value_in_micro_dollar",
                "src_total_inapp_app_install",
                "src_total_inapp_app_install_value_in_micro_dollar",
                "src_total_inapp_checkout",
                "src_total_inapp_checkout_value_in_micro_dollar",
                "src_total_inapp_click_add_to_cart",
                "src_total_inapp_click_add_to_cart_value_in_micro_dollar",
                "src_total_inapp_click_app_install",
                "src_total_inapp_click_app_install_value_in_micro_dollar",
                "src_total_inapp_click_checkout",
                "src_total_inapp_click_checkout_value_in_micro_dollar",
                "src_total_inapp_click_search",
                "src_total_inapp_click_search_value_in_micro_dollar",
                "src_total_inapp_click_signup",
                "src_total_inapp_click_signup_value_in_micro_dollar",
                "src_total_inapp_click_unknown",
                "src_total_inapp_click_unknown_value_in_micro_dollar",
                "src_total_inapp_engagement_add_to_cart",
                "src_total_inapp_engagement_add_to_cart_value_in_micro_dollar",
                "src_total_inapp_engagement_app_install",
                "src_total_inapp_engagement_app_install_value_in_micro_dollar",
                "src_total_inapp_engagement_checkout",
                "src_total_inapp_engagement_checkout_value_in_micro_dollar",
                "src_total_inapp_engagement_search",
                "src_total_inapp_engagement_search_value_in_micro_dollar",
                "src_total_inapp_engagement_signup",
                "src_total_inapp_engagement_signup_value_in_micro_dollar",
                "src_total_inapp_engagement_unknown",
                "src_total_inapp_engagement_unknown_value_in_micro_dollar",
                "src_total_inapp_search",
                "src_total_inapp_search_value_in_micro_dollar",
                "src_total_inapp_signup",
                "src_total_inapp_signup_value_in_micro_dollar",
                "src_total_inapp_unknown",
                "src_total_inapp_unknown_value_in_micro_dollar",
                "src_total_inapp_view_add_to_cart",
                "src_total_inapp_view_add_to_cart_value_in_micro_dollar",
                "src_total_inapp_view_app_install",
                "src_total_inapp_view_app_install_value_in_micro_dollar",
                "src_total_inapp_view_checkout",
                "src_total_inapp_view_checkout_value_in_micro_dollar",
                "src_total_inapp_view_search",
                "src_total_inapp_view_search_value_in_micro_dollar",
                "src_total_inapp_view_signup",
                "src_total_inapp_view_signup_value_in_micro_dollar",
                "src_total_inapp_view_unknown",
                "src_total_inapp_view_unknown_value_in_micro_dollar",
                "src_total_lead",
                "src_total_lead_desktop_action_to_desktop_conversion",
                "src_total_lead_desktop_action_to_mobile_conversion",
                "src_total_lead_desktop_action_to_tablet_conversion",
                "src_total_lead_mobile_action_to_desktop_conversion",
                "src_total_lead_mobile_action_to_mobile_conversion",
                "src_total_lead_mobile_action_to_tablet_conversion",
                "src_total_lead_tablet_action_to_desktop_conversion",
                "src_total_lead_tablet_action_to_mobile_conversion",
                "src_total_lead_tablet_action_to_tablet_conversion",
                "src_total_lead_value_in_micro_dollar",
                "src_total_offline_checkout",
                "src_total_offline_checkout_value_in_micro_dollar",
                "src_total_offline_click_checkout",
                "src_total_offline_click_checkout_value_in_micro_dollar",
                "src_total_offline_click_custom",
                "src_total_offline_click_custom_value_in_micro_dollar",
                "src_total_offline_click_lead",
                "src_total_offline_click_lead_value_in_micro_dollar",
                "src_total_offline_click_signup",
                "src_total_offline_click_signup_value_in_micro_dollar",
                "src_total_offline_click_unknown",
                "src_total_offline_click_unknown_value_in_micro_dollar",
                "src_total_offline_custom",
                "src_total_offline_custom_value_in_micro_dollar",
                "src_total_offline_engagement_checkout",
                "src_total_offline_engagement_checkout_value_in_micro_dollar",
                "src_total_offline_engagement_custom",
                "src_total_offline_engagement_custom_value_in_micro_dollar",
                "src_total_offline_engagement_lead",
                "src_total_offline_engagement_lead_value_in_micro_dollar",
                "src_total_offline_engagement_signup",
                "src_total_offline_engagement_signup_value_in_micro_dollar",
                "src_total_offline_engagement_unknown",
                "src_total_offline_engagement_unknown_value_in_micro_dollar",
                "src_total_offline_lead",
                "src_total_offline_lead_value_in_micro_dollar",
                "src_total_offline_signup",
                "src_total_offline_signup_value_in_micro_dollar",
                "src_total_offline_unknown",
                "src_total_offline_unknown_value_in_micro_dollar",
                "src_total_offline_view_checkout",
                "src_total_offline_view_checkout_value_in_micro_dollar",
                "src_total_offline_view_custom",
                "src_total_offline_view_custom_value_in_micro_dollar",
                "src_total_offline_view_lead",
                "src_total_offline_view_lead_value_in_micro_dollar",
                "src_total_offline_view_signup",
                "src_total_offline_view_signup_value_in_micro_dollar",
                "src_total_offline_view_unknown",
                "src_total_offline_view_unknown_value_in_micro_dollar",
                "src_total_page_visit",
                "src_total_page_visit_desktop_action_to_desktop_conversion",
                "src_total_page_visit_desktop_action_to_mobile_conversion",
                "src_total_page_visit_desktop_action_to_tablet_conversion",
                "src_total_page_visit_mobile_action_to_desktop_conversion",
                "src_total_page_visit_mobile_action_to_mobile_conversion",
                "src_total_page_visit_mobile_action_to_tablet_conversion",
                "src_total_page_visit_tablet_action_to_desktop_conversion",
                "src_total_page_visit_tablet_action_to_mobile_conversion",
                "src_total_page_visit_tablet_action_to_tablet_conversion",
                "src_total_pinterest_checkout",
                "src_total_pinterest_checkout_value_in_micro_dollar",
                "src_total_search",
                "src_total_search_desktop_action_to_desktop_conversion",
                "src_total_search_desktop_action_to_mobile_conversion",
                "src_total_search_desktop_action_to_tablet_conversion",
                "src_total_search_mobile_action_to_desktop_conversion",
                "src_total_search_mobile_action_to_mobile_conversion",
                "src_total_search_mobile_action_to_tablet_conversion",
                "src_total_search_tablet_action_to_desktop_conversion",
                "src_total_search_tablet_action_to_mobile_conversion",
                "src_total_search_tablet_action_to_tablet_conversion",
                "src_total_search_value_in_micro_dollar",
                "src_total_signup",
                "src_total_signup_desktop_action_to_desktop_conversion",
                "src_total_signup_desktop_action_to_mobile_conversion",
                "src_total_signup_desktop_action_to_tablet_conversion",
                "src_total_signup_mobile_action_to_desktop_conversion",
                "src_total_signup_mobile_action_to_mobile_conversion",
                "src_total_signup_mobile_action_to_tablet_conversion",
                "src_total_signup_tablet_action_to_desktop_conversion",
                "src_total_signup_tablet_action_to_mobile_conversion",
                "src_total_signup_tablet_action_to_tablet_conversion",
                "src_total_signup_value_in_micro_dollar",
                "src_total_unknown_desktop_action_to_desktop_conversion",
                "src_total_unknown_desktop_action_to_mobile_conversion",
                "src_total_unknown_desktop_action_to_tablet_conversion",
                "src_total_unknown_mobile_action_to_desktop_conversion",
                "src_total_unknown_mobile_action_to_mobile_conversion",
                "src_total_unknown_mobile_action_to_tablet_conversion",
                "src_total_unknown_tablet_action_to_desktop_conversion",
                "src_total_unknown_tablet_action_to_mobile_conversion",
                "src_total_unknown_tablet_action_to_tablet_conversion",
                "src_total_video_3sec_views",
                "src_total_video_avg_watchtime_in_second",
                "src_total_video_mrc_views",
                "src_total_video_p0_combined",
                "src_total_video_p100_complete",
                "src_total_video_p25_combined",
                "src_total_video_p50_combined",
                "src_total_video_p75_combined",
                "src_total_video_p95_combined",
                "src_total_view_add_to_cart",
                "src_total_view_add_to_cart_quantity",
                "src_total_view_add_to_cart_value_in_micro_dollar",
                "src_total_view_app_install",
                "src_total_view_app_install_value_in_micro_dollar",
                "src_total_view_category",
                "src_total_view_category_desktop_action_to_desktop_conversion",
                "src_total_view_category_desktop_action_to_mobile_conversion",
                "src_total_view_category_desktop_action_to_tablet_conversion",
                "src_total_view_category_mobile_action_to_desktop_conversion",
                "src_total_view_category_mobile_action_to_mobile_conversion",
                "src_total_view_category_mobile_action_to_tablet_conversion",
                "src_total_view_category_tablet_action_to_desktop_conversion",
                "src_total_view_category_tablet_action_to_mobile_conversion",
                "src_total_view_category_tablet_action_to_tablet_conversion",
                "src_total_view_category_value_in_micro_dollar",
                "src_total_view_checkout",
                "src_total_view_checkout_quantity",
                "src_total_view_checkout_value_in_micro_dollar",
                "src_total_view_custom",
                "src_total_view_custom_quantity",
                "src_total_view_custom_value_in_micro_dollar",
                "src_total_view_lead",
                "src_total_view_lead_quantity",
                "src_total_view_lead_value_in_micro_dollar",
                "src_total_view_page_visit",
                "src_total_view_page_visit_quantity",
                "src_total_view_page_visit_value_in_micro_dollar",
                "src_total_view_search",
                "src_total_view_search_quantity",
                "src_total_view_search_value_in_micro_dollar",
                "src_total_view_signup",
                "src_total_view_signup_quantity",
                "src_total_view_signup_value_in_micro_dollar",
                "src_total_view_unknown",
                "src_total_view_unknown_quantity",
                "src_total_view_unknown_value_in_micro_dollar",
                "src_total_view_view_category",
                "src_total_view_view_category_quantity",
                "src_total_view_view_category_value_in_micro_dollar",
                "src_total_view_watch_video",
                "src_total_view_watch_video_quantity",
                "src_total_view_watch_video_value_in_micro_dollar",
                "src_total_watch_video",
                "src_total_watch_video_desktop_action_to_desktop_conversion",
                "src_total_watch_video_desktop_action_to_mobile_conversion",
                "src_total_watch_video_desktop_action_to_tablet_conversion",
                "src_total_watch_video_mobile_action_to_desktop_conversion",
                "src_total_watch_video_mobile_action_to_mobile_conversion",
                "src_total_watch_video_mobile_action_to_tablet_conversion",
                "src_total_watch_video_tablet_action_to_desktop_conversion",
                "src_total_watch_video_tablet_action_to_mobile_conversion",
                "src_total_watch_video_tablet_action_to_tablet_conversion",
                "src_total_watch_video_value_in_micro_dollar",
                "src_total_web_add_to_cart",
                "src_total_web_add_to_cart_value_in_micro_dollar",
                "src_total_web_checkout",
                "src_total_web_checkout_value_in_micro_dollar",
                "src_total_web_click_add_to_cart",
                "src_total_web_click_add_to_cart_value_in_micro_dollar",
                "src_total_web_click_checkout",
                "src_total_web_click_checkout_value_in_micro_dollar",
                "src_total_web_click_custom",
                "src_total_web_click_custom_value_in_micro_dollar",
                "src_total_web_click_lead",
                "src_total_web_click_lead_value_in_micro_dollar",
                "src_total_web_click_page_visit",
                "src_total_web_click_page_visit_value_in_micro_dollar",
                "src_total_web_click_search",
                "src_total_web_click_search_value_in_micro_dollar",
                "src_total_web_click_signup",
                "src_total_web_click_signup_value_in_micro_dollar",
                "src_total_web_click_unknown",
                "src_total_web_click_unknown_value_in_micro_dollar",
                "src_total_web_click_view_category",
                "src_total_web_click_view_category_value_in_micro_dollar",
                "src_total_web_click_watch_video",
                "src_total_web_click_watch_video_value_in_micro_dollar",
                "src_total_web_custom",
                "src_total_web_custom_value_in_micro_dollar",
                "src_total_web_engagement_add_to_cart",
                "src_total_web_engagement_add_to_cart_value_in_micro_dollar",
                "src_total_web_engagement_checkout",
                "src_total_web_engagement_checkout_value_in_micro_dollar",
                "src_total_web_engagement_custom",
                "src_total_web_engagement_custom_value_in_micro_dollar",
                "src_total_web_engagement_lead",
                "src_total_web_engagement_lead_value_in_micro_dollar",
                "src_total_web_engagement_page_visit",
                "src_total_web_engagement_page_visit_value_in_micro_dollar",
                "src_total_web_engagement_search",
                "src_total_web_engagement_search_value_in_micro_dollar",
                "src_total_web_engagement_signup",
                "src_total_web_engagement_signup_value_in_micro_dollar",
                "src_total_web_engagement_unknown",
                "src_total_web_engagement_unknown_value_in_micro_dollar",
                "src_total_web_engagement_view_category",
                "src_total_web_engagement_view_category_value_in_micro_dollar",
                "src_total_web_engagement_watch_video",
                "src_total_web_engagement_watch_video_value_in_micro_dollar",
                "src_total_web_lead",
                "src_total_web_lead_value_in_micro_dollar",
                "src_total_web_page_visit",
                "src_total_web_page_visit_value_in_micro_dollar",
                "src_total_web_search",
                "src_total_web_search_value_in_micro_dollar",
                "src_total_web_sessions",
                "src_total_web_signup",
                "src_total_web_signup_value_in_micro_dollar",
                "src_total_web_unknown",
                "src_total_web_unknown_value_in_micro_dollar",
                "src_total_web_view_add_to_cart",
                "src_total_web_view_add_to_cart_value_in_micro_dollar",
                "src_total_web_view_category",
                "src_total_web_view_category_value_in_micro_dollar",
                "src_total_web_view_checkout",
                "src_total_web_view_checkout_value_in_micro_dollar",
                "src_total_web_view_custom",
                "src_total_web_view_custom_value_in_micro_dollar",
                "src_total_web_view_lead",
                "src_total_web_view_lead_value_in_micro_dollar",
                "src_total_web_view_page_visit",
                "src_total_web_view_page_visit_value_in_micro_dollar",
                "src_total_web_view_search",
                "src_total_web_view_search_value_in_micro_dollar",
                "src_total_web_view_signup",
                "src_total_web_view_signup_value_in_micro_dollar",
                "src_total_web_view_unknown",
                "src_total_web_view_unknown_value_in_micro_dollar",
                "src_total_web_view_view_category",
                "src_total_web_view_view_category_value_in_micro_dollar",
                "src_total_web_view_watch_video",
                "src_total_web_view_watch_video_value_in_micro_dollar",
                "src_total_web_watch_video",
                "src_total_web_watch_video_value_in_micro_dollar",
                "src_video_3sec_views_1",
                "src_video_3sec_views_2",
                "src_video_avg_watchtime_in_second_1",
                "src_video_avg_watchtime_in_second_2",
                "src_video_length",
                "src_video_mrc_views_1",
                "src_video_mrc_views_2",
                "src_video_p0_combined_1",
                "src_video_p0_combined_2",
                "src_video_p100_complete_1",
                "src_video_p100_complete_2",
                "src_video_p25_combined_1",
                "src_video_p25_combined_2",
                "src_video_p50_combined_1",
                "src_video_p50_combined_2",
                "src_video_p75_combined_1",
                "src_video_p75_combined_2",
                "src_video_p95_combined_1",
                "src_video_p95_combined_2",
                "src_web_sessions_1",
                "src_web_sessions_2",
                "data_as_of_ts",
                "file_name",
                "file_row_number",
                "date_wid",
                "created_batch_id",
                "created_ts",
                "modified_batch_id",
                "modified_ts"
]


class DeliveryPinterestAdGroup(Delivery):
    def merge_data(self, session, logger, target, mapped_delivery_df):
        target.merge(mapped_delivery_df,
                     ((target["line_item_lineage_id"] == mapped_delivery_df["line_item_lineage_id"]) &
                      (target["agency_id"] == mapped_delivery_df["agency_id"]) &
                      (target["pinterest_campaign_id"] == mapped_delivery_df["pinterest_campaign_id"]) &
                      (target["pinterest_ad_group_id"] == mapped_delivery_df["pinterest_ad_group_id"]) &
                      (target["delivered_on_date"] == mapped_delivery_df["delivered_on_date"]) &
                      (target["delivery_data_representation_id"] == mapped_delivery_df["delivery_data_representation_id"])),
                     [F.when_matched().update({
                                        "pinterest_advertiser_id": mapped_delivery_df["pinterest_advertiser_id"],
                                        "pinterest_order_line_id": mapped_delivery_df["pinterest_order_line_id"],
                                        "ad_group_status": mapped_delivery_df["ad_group_status"],
                                        "campaign_managed_status": mapped_delivery_df["campaign_managed_status"],
                                        "src_campaign_lifetime_spend_cap": mapped_delivery_df["src_campaign_lifetime_spend_cap"],
                                        "src_campaign_daily_spend_cap": mapped_delivery_df["src_campaign_daily_spend_cap"],
                                        "src_clickthrough_1": mapped_delivery_df["src_clickthrough_1"],
                                        "src_clickthrough_1_gross": mapped_delivery_df["src_clickthrough_1_gross"],
                                        "src_clickthrough_2": mapped_delivery_df["src_clickthrough_2"],
                                        "src_engagement_1": mapped_delivery_df["src_engagement_1"],
                                        "src_engagement_2": mapped_delivery_df["src_engagement_2"],
                                        "src_idea_pin_product_tag_visit_1": mapped_delivery_df["src_idea_pin_product_tag_visit_1"],
                                        "src_idea_pin_product_tag_visit_2": mapped_delivery_df["src_idea_pin_product_tag_visit_2"],
                                        "src_impression_1": mapped_delivery_df["src_impression_1"],
                                        "src_impression_1_gross": mapped_delivery_df["src_impression_1_gross"],
                                        "src_impression_2": mapped_delivery_df["src_impression_2"],
                                        "src_leads": mapped_delivery_df["src_leads"],
                                        "src_onsite_checkouts_1": mapped_delivery_df["src_onsite_checkouts_1"],
                                        "order_line_name": F.when(mapped_delivery_df["order_line_name"]=='', None).otherwise(mapped_delivery_df["order_line_name"]),
                                        "src_outbound_click_1": mapped_delivery_df["src_outbound_click_1"],
                                        "src_outbound_click_2": mapped_delivery_df["src_outbound_click_2"],
                                        "src_paid_impression": mapped_delivery_df["src_paid_impression"],
                                        "src_quiz_completed": mapped_delivery_df["src_quiz_completed"],
                                        "src_repin_1": mapped_delivery_df["src_repin_1"],
                                        "src_repin_2": mapped_delivery_df["src_repin_2"],
                                        "src_showcase_average_subpage_closeup_per_session": mapped_delivery_df["src_showcase_average_subpage_closeup_per_session"],
                                        "src_showcase_card_thumbnail_swipe_backward": mapped_delivery_df["src_showcase_card_thumbnail_swipe_backward"],
                                        "src_showcase_card_thumbnail_swipe_forward": mapped_delivery_df["src_showcase_card_thumbnail_swipe_forward"],
                                        "src_showcase_pin_clickthrough": mapped_delivery_df["src_showcase_pin_clickthrough"],
                                        "src_showcase_subpage_clickthrough": mapped_delivery_df["src_showcase_subpage_clickthrough"],
                                        "src_showcase_subpage_closeup": mapped_delivery_df["src_showcase_subpage_closeup"],
                                        "src_showcase_subpage_impression": mapped_delivery_df["src_showcase_subpage_impression"],
                                        "src_showcase_subpage_repin": mapped_delivery_df["src_showcase_subpage_repin"],
                                        "src_showcase_subpage_swipe_left": mapped_delivery_df["src_showcase_subpage_swipe_left"],
                                        "src_showcase_subpage_swipe_right": mapped_delivery_df["src_showcase_subpage_swipe_right"],
                                        "src_showcase_subpin_clickthrough": mapped_delivery_df["src_showcase_subpin_clickthrough"],
                                        "src_showcase_subpin_impression": mapped_delivery_df["src_showcase_subpin_impression"],
                                        "src_showcase_subpin_repin": mapped_delivery_df["src_showcase_subpin_repin"],
                                        "src_showcase_subpin_swipe_left": mapped_delivery_df["src_showcase_subpin_swipe_left"],
                                        "src_showcase_subpin_swipe_right": mapped_delivery_df["src_showcase_subpin_swipe_right"],
                                        "src_spend_in_dollar": mapped_delivery_df["src_spend_in_dollar"],
                                        "src_spend_in_micro_dollar": mapped_delivery_df["src_spend_in_micro_dollar"],
                                        "src_total_add_to_cart": mapped_delivery_df["src_total_add_to_cart"],
                                        "src_total_add_to_cart_desktop_action_to_desktop_conversion": mapped_delivery_df["src_total_add_to_cart_desktop_action_to_desktop_conversion"],
                                        "src_total_add_to_cart_desktop_action_to_mobile_conversion": mapped_delivery_df["src_total_add_to_cart_desktop_action_to_mobile_conversion"],
                                        "src_total_add_to_cart_desktop_action_to_tablet_conversion": mapped_delivery_df["src_total_add_to_cart_desktop_action_to_tablet_conversion"],
                                        "src_total_add_to_cart_mobile_action_to_desktop_conversion": mapped_delivery_df["src_total_add_to_cart_mobile_action_to_desktop_conversion"],
                                        "src_total_add_to_cart_mobile_action_to_mobile_conversion": mapped_delivery_df["src_total_add_to_cart_mobile_action_to_mobile_conversion"],
                                        "src_total_add_to_cart_mobile_action_to_tablet_conversion": mapped_delivery_df["src_total_add_to_cart_mobile_action_to_tablet_conversion"],
                                        "src_total_add_to_cart_tablet_action_to_desktop_conversion": mapped_delivery_df["src_total_add_to_cart_tablet_action_to_desktop_conversion"],
                                        "src_total_add_to_cart_tablet_action_to_mobile_conversion": mapped_delivery_df["src_total_add_to_cart_tablet_action_to_mobile_conversion"],
                                        "src_total_add_to_cart_tablet_action_to_tablet_conversion": mapped_delivery_df["src_total_add_to_cart_tablet_action_to_tablet_conversion"],
                                        "src_total_add_to_cart_value_in_micro_dollar": mapped_delivery_df["src_total_add_to_cart_value_in_micro_dollar"],
                                        "src_total_app_install": mapped_delivery_df["src_total_app_install"],
                                        "src_total_app_install_desktop_action_to_desktop_conversion": mapped_delivery_df["src_total_app_install_desktop_action_to_desktop_conversion"],
                                        "src_total_app_install_desktop_action_to_mobile_conversion": mapped_delivery_df["src_total_app_install_desktop_action_to_mobile_conversion"],
                                        "src_total_app_install_desktop_action_to_tablet_conversion": mapped_delivery_df["src_total_app_install_desktop_action_to_tablet_conversion"],
                                        "src_total_app_install_mobile_action_to_desktop_conversion": mapped_delivery_df["src_total_app_install_mobile_action_to_desktop_conversion"],
                                        "src_total_app_install_mobile_action_to_mobile_conversion": mapped_delivery_df["src_total_app_install_mobile_action_to_mobile_conversion"],
                                        "src_total_app_install_mobile_action_to_tablet_conversion": mapped_delivery_df["src_total_app_install_mobile_action_to_tablet_conversion"],
                                        "src_total_app_install_tablet_action_to_desktop_conversion": mapped_delivery_df["src_total_app_install_tablet_action_to_desktop_conversion"],
                                        "src_total_app_install_tablet_action_to_mobile_conversion": mapped_delivery_df["src_total_app_install_tablet_action_to_mobile_conversion"],
                                        "src_total_app_install_tablet_action_to_tablet_conversion": mapped_delivery_df["src_total_app_install_tablet_action_to_tablet_conversion"],
                                        "src_total_app_install_value_in_micro_dollar": mapped_delivery_df["src_total_app_install_value_in_micro_dollar"],
                                        "src_total_checkout": mapped_delivery_df["src_total_checkout"],
                                        "src_total_checkout_desktop_action_to_desktop_conversion": mapped_delivery_df["src_total_checkout_desktop_action_to_desktop_conversion"],
                                        "src_total_checkout_desktop_action_to_mobile_conversion": mapped_delivery_df["src_total_checkout_desktop_action_to_mobile_conversion"],
                                        "src_total_checkout_desktop_action_to_tablet_conversion": mapped_delivery_df["src_total_checkout_desktop_action_to_tablet_conversion"],
                                        "src_total_checkout_mobile_action_to_desktop_conversion": mapped_delivery_df["src_total_checkout_mobile_action_to_desktop_conversion"],
                                        "src_total_checkout_mobile_action_to_mobile_conversion": mapped_delivery_df["src_total_checkout_mobile_action_to_mobile_conversion"],
                                        "src_total_checkout_mobile_action_to_tablet_conversion": mapped_delivery_df["src_total_checkout_mobile_action_to_tablet_conversion"],
                                        "src_total_checkout_quantity": mapped_delivery_df["src_total_checkout_quantity"],
                                        "src_total_checkout_tablet_action_to_desktop_conversion": mapped_delivery_df["src_total_checkout_tablet_action_to_desktop_conversion"],
                                        "src_total_checkout_tablet_action_to_mobile_conversion": mapped_delivery_df["src_total_checkout_tablet_action_to_mobile_conversion"],
                                        "src_total_checkout_tablet_action_to_tablet_conversion": mapped_delivery_df["src_total_checkout_tablet_action_to_tablet_conversion"],
                                        "src_total_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_checkout_value_in_micro_dollar"],
                                        "src_total_click_add_to_cart": mapped_delivery_df["src_total_click_add_to_cart"],
                                        "src_total_click_add_to_cart_quantity": mapped_delivery_df["src_total_click_add_to_cart_quantity"],
                                        "src_total_click_add_to_cart_value_in_micro_dollar": mapped_delivery_df["src_total_click_add_to_cart_value_in_micro_dollar"],
                                        "src_total_click_app_install": mapped_delivery_df["src_total_click_app_install"],
                                        "src_total_click_app_install_value_in_micro_dollar": mapped_delivery_df["src_total_click_app_install_value_in_micro_dollar"],
                                        "src_total_click_checkout": mapped_delivery_df["src_total_click_checkout"],
                                        "src_total_click_checkout_quantity": mapped_delivery_df["src_total_click_checkout_quantity"],
                                        "src_total_click_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_click_checkout_value_in_micro_dollar"],
                                        "src_total_click_custom": mapped_delivery_df["src_total_click_custom"],
                                        "src_total_click_custom_quantity": mapped_delivery_df["src_total_click_custom_quantity"],
                                        "src_total_click_custom_value_in_micro_dollar": mapped_delivery_df["src_total_click_custom_value_in_micro_dollar"],
                                        "src_total_click_lead": mapped_delivery_df["src_total_click_lead"],
                                        "src_total_click_lead_quantity": mapped_delivery_df["src_total_click_lead_quantity"],
                                        "src_total_click_lead_value_in_micro_dollar": mapped_delivery_df["src_total_click_lead_value_in_micro_dollar"],
                                        "src_total_click_page_visit": mapped_delivery_df["src_total_click_page_visit"],
                                        "src_total_click_page_visit_quantity": mapped_delivery_df["src_total_click_page_visit_quantity"],
                                        "src_total_click_page_visit_value_in_micro_dollar": mapped_delivery_df["src_total_click_page_visit_value_in_micro_dollar"],
                                        "src_total_click_search": mapped_delivery_df["src_total_click_search"],
                                        "src_total_click_search_quantity": mapped_delivery_df["src_total_click_search_quantity"],
                                        "src_total_click_search_value_in_micro_dollar": mapped_delivery_df["src_total_click_search_value_in_micro_dollar"],
                                        "src_total_click_signup": mapped_delivery_df["src_total_click_signup"],
                                        "src_total_click_signup_quantity": mapped_delivery_df["src_total_click_signup_quantity"],
                                        "src_total_click_signup_value_in_micro_dollar": mapped_delivery_df["src_total_click_signup_value_in_micro_dollar"],
                                        "src_total_clickthrough": mapped_delivery_df["src_total_clickthrough"],
                                        "src_total_click_unknown": mapped_delivery_df["src_total_click_unknown"],
                                        "src_total_click_unknown_quantity": mapped_delivery_df["src_total_click_unknown_quantity"],
                                        "src_total_click_unknown_value_in_micro_dollar": mapped_delivery_df["src_total_click_unknown_value_in_micro_dollar"],
                                        "src_total_click_view_category": mapped_delivery_df["src_total_click_view_category"],
                                        "src_total_click_view_category_quantity": mapped_delivery_df["src_total_click_view_category_quantity"],
                                        "src_total_click_view_category_value_in_micro_dollar": mapped_delivery_df["src_total_click_view_category_value_in_micro_dollar"],
                                        "src_total_click_watch_video": mapped_delivery_df["src_total_click_watch_video"],
                                        "src_total_click_watch_video_quantity": mapped_delivery_df["src_total_click_watch_video_quantity"],
                                        "src_total_click_watch_video_value_in_micro_dollar": mapped_delivery_df["src_total_click_watch_video_value_in_micro_dollar"],
                                        "src_total_conversions": mapped_delivery_df["src_total_conversions"],
                                        "src_total_conversions_quantity": mapped_delivery_df["src_total_conversions_quantity"],
                                        "src_total_conversions_value_in_micro_dollar": mapped_delivery_df["src_total_conversions_value_in_micro_dollar"],
                                        "src_total_custom": mapped_delivery_df["src_total_custom"],
                                        "src_total_custom_desktop_action_to_desktop_conversion": mapped_delivery_df["src_total_custom_desktop_action_to_desktop_conversion"],
                                        "src_total_custom_desktop_action_to_mobile_conversion": mapped_delivery_df["src_total_custom_desktop_action_to_mobile_conversion"],
                                        "src_total_custom_desktop_action_to_tablet_conversion": mapped_delivery_df["src_total_custom_desktop_action_to_tablet_conversion"],
                                        "src_total_custom_mobile_action_to_desktop_conversion": mapped_delivery_df["src_total_custom_mobile_action_to_desktop_conversion"],
                                        "src_total_custom_mobile_action_to_mobile_conversion": mapped_delivery_df["src_total_custom_mobile_action_to_mobile_conversion"],
                                        "src_total_custom_mobile_action_to_tablet_conversion": mapped_delivery_df["src_total_custom_mobile_action_to_tablet_conversion"],
                                        "src_total_custom_tablet_action_to_desktop_conversion": mapped_delivery_df["src_total_custom_tablet_action_to_desktop_conversion"],
                                        "src_total_custom_tablet_action_to_mobile_conversion": mapped_delivery_df["src_total_custom_tablet_action_to_mobile_conversion"],
                                        "src_total_custom_tablet_action_to_tablet_conversion": mapped_delivery_df["src_total_custom_tablet_action_to_tablet_conversion"],
                                        "src_total_custom_value_in_micro_dollar": mapped_delivery_df["src_total_custom_value_in_micro_dollar"],
                                        "src_total_destination_views": mapped_delivery_df["src_total_destination_views"],
                                        "src_total_engagement": mapped_delivery_df["src_total_engagement"],
                                        "src_total_engagement_add_to_cart": mapped_delivery_df["src_total_engagement_add_to_cart"],
                                        "src_total_engagement_add_to_cart_quantity": mapped_delivery_df["src_total_engagement_add_to_cart_quantity"],
                                        "src_total_engagement_add_to_cart_value_in_micro_dollar": mapped_delivery_df["src_total_engagement_add_to_cart_value_in_micro_dollar"],
                                        "src_total_engagement_app_install": mapped_delivery_df["src_total_engagement_app_install"],
                                        "src_total_engagement_app_install_value_in_micro_dollar": mapped_delivery_df["src_total_engagement_app_install_value_in_micro_dollar"],
                                        "src_total_engagement_checkout": mapped_delivery_df["src_total_engagement_checkout"],
                                        "src_total_engagement_checkout_quantity": mapped_delivery_df["src_total_engagement_checkout_quantity"],
                                        "src_total_engagement_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_engagement_checkout_value_in_micro_dollar"],
                                        "src_total_engagement_custom": mapped_delivery_df["src_total_engagement_custom"],
                                        "src_total_engagement_custom_quantity": mapped_delivery_df["src_total_engagement_custom_quantity"],
                                        "src_total_engagement_custom_value_in_micro_dollar": mapped_delivery_df["src_total_engagement_custom_value_in_micro_dollar"],
                                        "src_total_engagement_lead": mapped_delivery_df["src_total_engagement_lead"],
                                        "src_total_engagement_lead_quantity": mapped_delivery_df["src_total_engagement_lead_quantity"],
                                        "src_total_engagement_lead_value_in_micro_dollar": mapped_delivery_df["src_total_engagement_lead_value_in_micro_dollar"],
                                        "src_total_engagement_page_visit": mapped_delivery_df["src_total_engagement_page_visit"],
                                        "src_total_engagement_page_visit_quantity": mapped_delivery_df["src_total_engagement_page_visit_quantity"],
                                        "src_total_engagement_page_visit_value_in_micro_dollar": mapped_delivery_df["src_total_engagement_page_visit_value_in_micro_dollar"],
                                        "src_total_engagement_search": mapped_delivery_df["src_total_engagement_search"],
                                        "src_total_engagement_search_quantity": mapped_delivery_df["src_total_engagement_search_quantity"],
                                        "src_total_engagement_search_value_in_micro_dollar": mapped_delivery_df["src_total_engagement_search_value_in_micro_dollar"],
                                        "src_total_engagement_signup": mapped_delivery_df["src_total_engagement_signup"],
                                        "src_total_engagement_signup_quantity": mapped_delivery_df["src_total_engagement_signup_quantity"],
                                        "src_total_engagement_signup_value_in_micro_dollar": mapped_delivery_df["src_total_engagement_signup_value_in_micro_dollar"],
                                        "src_total_engagement_unknown": mapped_delivery_df["src_total_engagement_unknown"],
                                        "src_total_engagement_unknown_quantity": mapped_delivery_df["src_total_engagement_unknown_quantity"],
                                        "src_total_engagement_unknown_value_in_micro_dollar": mapped_delivery_df["src_total_engagement_unknown_value_in_micro_dollar"],
                                        "src_total_engagement_view_category": mapped_delivery_df["src_total_engagement_view_category"],
                                        "src_total_engagement_view_category_quantity": mapped_delivery_df["src_total_engagement_view_category_quantity"],
                                        "src_total_engagement_view_category_value_in_micro_dollar": mapped_delivery_df["src_total_engagement_view_category_value_in_micro_dollar"],
                                        "src_total_engagement_watch_video": mapped_delivery_df["src_total_engagement_watch_video"],
                                        "src_total_engagement_watch_video_quantity": mapped_delivery_df["src_total_engagement_watch_video_quantity"],
                                        "src_total_engagement_watch_video_value_in_micro_dollar": mapped_delivery_df["src_total_engagement_watch_video_value_in_micro_dollar"],
                                        "src_total_idea_pin_product_tag_visit": mapped_delivery_df["src_total_idea_pin_product_tag_visit"],
                                        "src_total_impression": mapped_delivery_df["src_total_impression"],
                                        "src_total_inapp_add_to_cart": mapped_delivery_df["src_total_inapp_add_to_cart"],
                                        "src_total_inapp_add_to_cart_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_add_to_cart_value_in_micro_dollar"],
                                        "src_total_inapp_app_install": mapped_delivery_df["src_total_inapp_app_install"],
                                        "src_total_inapp_app_install_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_app_install_value_in_micro_dollar"],
                                        "src_total_inapp_checkout": mapped_delivery_df["src_total_inapp_checkout"],
                                        "src_total_inapp_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_checkout_value_in_micro_dollar"],
                                        "src_total_inapp_click_add_to_cart": mapped_delivery_df["src_total_inapp_click_add_to_cart"],
                                        "src_total_inapp_click_add_to_cart_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_click_add_to_cart_value_in_micro_dollar"],
                                        "src_total_inapp_click_app_install": mapped_delivery_df["src_total_inapp_click_app_install"],
                                        "src_total_inapp_click_app_install_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_click_app_install_value_in_micro_dollar"],
                                        "src_total_inapp_click_checkout": mapped_delivery_df["src_total_inapp_click_checkout"],
                                        "src_total_inapp_click_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_click_checkout_value_in_micro_dollar"],
                                        "src_total_inapp_click_search": mapped_delivery_df["src_total_inapp_click_search"],
                                        "src_total_inapp_click_search_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_click_search_value_in_micro_dollar"],
                                        "src_total_inapp_click_signup": mapped_delivery_df["src_total_inapp_click_signup"],
                                        "src_total_inapp_click_signup_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_click_signup_value_in_micro_dollar"],
                                        "src_total_inapp_click_unknown": mapped_delivery_df["src_total_inapp_click_unknown"],
                                        "src_total_inapp_click_unknown_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_click_unknown_value_in_micro_dollar"],
                                        "src_total_inapp_engagement_add_to_cart": mapped_delivery_df["src_total_inapp_engagement_add_to_cart"],
                                        "src_total_inapp_engagement_add_to_cart_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_engagement_add_to_cart_value_in_micro_dollar"],
                                        "src_total_inapp_engagement_app_install": mapped_delivery_df["src_total_inapp_engagement_app_install"],
                                        "src_total_inapp_engagement_app_install_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_engagement_app_install_value_in_micro_dollar"],
                                        "src_total_inapp_engagement_checkout": mapped_delivery_df["src_total_inapp_engagement_checkout"],
                                        "src_total_inapp_engagement_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_engagement_checkout_value_in_micro_dollar"],
                                        "src_total_inapp_engagement_search": mapped_delivery_df["src_total_inapp_engagement_search"],
                                        "src_total_inapp_engagement_search_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_engagement_search_value_in_micro_dollar"],
                                        "src_total_inapp_engagement_signup": mapped_delivery_df["src_total_inapp_engagement_signup"],
                                        "src_total_inapp_engagement_signup_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_engagement_signup_value_in_micro_dollar"],
                                        "src_total_inapp_engagement_unknown": mapped_delivery_df["src_total_inapp_engagement_unknown"],
                                        "src_total_inapp_engagement_unknown_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_engagement_unknown_value_in_micro_dollar"],
                                        "src_total_inapp_search": mapped_delivery_df["src_total_inapp_search"],
                                        "src_total_inapp_search_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_search_value_in_micro_dollar"],
                                        "src_total_inapp_signup": mapped_delivery_df["src_total_inapp_signup"],
                                        "src_total_inapp_signup_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_signup_value_in_micro_dollar"],
                                        "src_total_inapp_unknown": mapped_delivery_df["src_total_inapp_unknown"],
                                        "src_total_inapp_unknown_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_unknown_value_in_micro_dollar"],
                                        "src_total_inapp_view_add_to_cart": mapped_delivery_df["src_total_inapp_view_add_to_cart"],
                                        "src_total_inapp_view_add_to_cart_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_view_add_to_cart_value_in_micro_dollar"],
                                        "src_total_inapp_view_app_install": mapped_delivery_df["src_total_inapp_view_app_install"],
                                        "src_total_inapp_view_app_install_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_view_app_install_value_in_micro_dollar"],
                                        "src_total_inapp_view_checkout": mapped_delivery_df["src_total_inapp_view_checkout"],
                                        "src_total_inapp_view_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_view_checkout_value_in_micro_dollar"],
                                        "src_total_inapp_view_search": mapped_delivery_df["src_total_inapp_view_search"],
                                        "src_total_inapp_view_search_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_view_search_value_in_micro_dollar"],
                                        "src_total_inapp_view_signup": mapped_delivery_df["src_total_inapp_view_signup"],
                                        "src_total_inapp_view_signup_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_view_signup_value_in_micro_dollar"],
                                        "src_total_inapp_view_unknown": mapped_delivery_df["src_total_inapp_view_unknown"],
                                        "src_total_inapp_view_unknown_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_view_unknown_value_in_micro_dollar"],
                                        "src_total_lead": mapped_delivery_df["src_total_lead"],
                                        "src_total_lead_desktop_action_to_desktop_conversion": mapped_delivery_df["src_total_lead_desktop_action_to_desktop_conversion"],
                                        "src_total_lead_desktop_action_to_mobile_conversion": mapped_delivery_df["src_total_lead_desktop_action_to_mobile_conversion"],
                                        "src_total_lead_desktop_action_to_tablet_conversion": mapped_delivery_df["src_total_lead_desktop_action_to_tablet_conversion"],
                                        "src_total_lead_mobile_action_to_desktop_conversion": mapped_delivery_df["src_total_lead_mobile_action_to_desktop_conversion"],
                                        "src_total_lead_mobile_action_to_mobile_conversion": mapped_delivery_df["src_total_lead_mobile_action_to_mobile_conversion"],
                                        "src_total_lead_mobile_action_to_tablet_conversion": mapped_delivery_df["src_total_lead_mobile_action_to_tablet_conversion"],
                                        "src_total_lead_tablet_action_to_desktop_conversion": mapped_delivery_df["src_total_lead_tablet_action_to_desktop_conversion"],
                                        "src_total_lead_tablet_action_to_mobile_conversion": mapped_delivery_df["src_total_lead_tablet_action_to_mobile_conversion"],
                                        "src_total_lead_tablet_action_to_tablet_conversion": mapped_delivery_df["src_total_lead_tablet_action_to_tablet_conversion"],
                                        "src_total_lead_value_in_micro_dollar": mapped_delivery_df["src_total_lead_value_in_micro_dollar"],
                                        "src_total_offline_checkout": mapped_delivery_df["src_total_offline_checkout"],
                                        "src_total_offline_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_offline_checkout_value_in_micro_dollar"],
                                        "src_total_offline_click_checkout": mapped_delivery_df["src_total_offline_click_checkout"],
                                        "src_total_offline_click_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_offline_click_checkout_value_in_micro_dollar"],
                                        "src_total_offline_click_custom": mapped_delivery_df["src_total_offline_click_custom"],
                                        "src_total_offline_click_custom_value_in_micro_dollar": mapped_delivery_df["src_total_offline_click_custom_value_in_micro_dollar"],
                                        "src_total_offline_click_lead": mapped_delivery_df["src_total_offline_click_lead"],
                                        "src_total_offline_click_lead_value_in_micro_dollar": mapped_delivery_df["src_total_offline_click_lead_value_in_micro_dollar"],
                                        "src_total_offline_click_signup": mapped_delivery_df["src_total_offline_click_signup"],
                                        "src_total_offline_click_signup_value_in_micro_dollar": mapped_delivery_df["src_total_offline_click_signup_value_in_micro_dollar"],
                                        "src_total_offline_click_unknown": mapped_delivery_df["src_total_offline_click_unknown"],
                                        "src_total_offline_click_unknown_value_in_micro_dollar": mapped_delivery_df["src_total_offline_click_unknown_value_in_micro_dollar"],
                                        "src_total_offline_custom": mapped_delivery_df["src_total_offline_custom"],
                                        "src_total_offline_custom_value_in_micro_dollar": mapped_delivery_df["src_total_offline_custom_value_in_micro_dollar"],
                                        "src_total_offline_engagement_checkout": mapped_delivery_df["src_total_offline_engagement_checkout"],
                                        "src_total_offline_engagement_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_offline_engagement_checkout_value_in_micro_dollar"],
                                        "src_total_offline_engagement_custom": mapped_delivery_df["src_total_offline_engagement_custom"],
                                        "src_total_offline_engagement_custom_value_in_micro_dollar": mapped_delivery_df["src_total_offline_engagement_custom_value_in_micro_dollar"],
                                        "src_total_offline_engagement_lead": mapped_delivery_df["src_total_offline_engagement_lead"],
                                        "src_total_offline_engagement_lead_value_in_micro_dollar": mapped_delivery_df["src_total_offline_engagement_lead_value_in_micro_dollar"],
                                        "src_total_offline_engagement_signup": mapped_delivery_df["src_total_offline_engagement_signup"],
                                        "src_total_offline_engagement_signup_value_in_micro_dollar": mapped_delivery_df["src_total_offline_engagement_signup_value_in_micro_dollar"],
                                        "src_total_offline_engagement_unknown": mapped_delivery_df["src_total_offline_engagement_unknown"],
                                        "src_total_offline_engagement_unknown_value_in_micro_dollar": mapped_delivery_df["src_total_offline_engagement_unknown_value_in_micro_dollar"],
                                        "src_total_offline_lead": mapped_delivery_df["src_total_offline_lead"],
                                        "src_total_offline_lead_value_in_micro_dollar": mapped_delivery_df["src_total_offline_lead_value_in_micro_dollar"],
                                        "src_total_offline_signup": mapped_delivery_df["src_total_offline_signup"],
                                        "src_total_offline_signup_value_in_micro_dollar": mapped_delivery_df["src_total_offline_signup_value_in_micro_dollar"],
                                        "src_total_offline_unknown": mapped_delivery_df["src_total_offline_unknown"],
                                        "src_total_offline_unknown_value_in_micro_dollar": mapped_delivery_df["src_total_offline_unknown_value_in_micro_dollar"],
                                        "src_total_offline_view_checkout": mapped_delivery_df["src_total_offline_view_checkout"],
                                        "src_total_offline_view_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_offline_view_checkout_value_in_micro_dollar"],
                                        "src_total_offline_view_custom": mapped_delivery_df["src_total_offline_view_custom"],
                                        "src_total_offline_view_custom_value_in_micro_dollar": mapped_delivery_df["src_total_offline_view_custom_value_in_micro_dollar"],
                                        "src_total_offline_view_lead": mapped_delivery_df["src_total_offline_view_lead"],
                                        "src_total_offline_view_lead_value_in_micro_dollar": mapped_delivery_df["src_total_offline_view_lead_value_in_micro_dollar"],
                                        "src_total_offline_view_signup": mapped_delivery_df["src_total_offline_view_signup"],
                                        "src_total_offline_view_signup_value_in_micro_dollar": mapped_delivery_df["src_total_offline_view_signup_value_in_micro_dollar"],
                                        "src_total_offline_view_unknown": mapped_delivery_df["src_total_offline_view_unknown"],
                                        "src_total_offline_view_unknown_value_in_micro_dollar": mapped_delivery_df["src_total_offline_view_unknown_value_in_micro_dollar"],
                                        "src_total_page_visit": mapped_delivery_df["src_total_page_visit"],
                                        "src_total_page_visit_desktop_action_to_desktop_conversion": mapped_delivery_df["src_total_page_visit_desktop_action_to_desktop_conversion"],
                                        "src_total_page_visit_desktop_action_to_mobile_conversion": mapped_delivery_df["src_total_page_visit_desktop_action_to_mobile_conversion"],
                                        "src_total_page_visit_desktop_action_to_tablet_conversion": mapped_delivery_df["src_total_page_visit_desktop_action_to_tablet_conversion"],
                                        "src_total_page_visit_mobile_action_to_desktop_conversion": mapped_delivery_df["src_total_page_visit_mobile_action_to_desktop_conversion"],
                                        "src_total_page_visit_mobile_action_to_mobile_conversion": mapped_delivery_df["src_total_page_visit_mobile_action_to_mobile_conversion"],
                                        "src_total_page_visit_mobile_action_to_tablet_conversion": mapped_delivery_df["src_total_page_visit_mobile_action_to_tablet_conversion"],
                                        "src_total_page_visit_tablet_action_to_desktop_conversion": mapped_delivery_df["src_total_page_visit_tablet_action_to_desktop_conversion"],
                                        "src_total_page_visit_tablet_action_to_mobile_conversion": mapped_delivery_df["src_total_page_visit_tablet_action_to_mobile_conversion"],
                                        "src_total_page_visit_tablet_action_to_tablet_conversion": mapped_delivery_df["src_total_page_visit_tablet_action_to_tablet_conversion"],
                                        "src_total_pinterest_checkout": mapped_delivery_df["src_total_pinterest_checkout"],
                                        "src_total_pinterest_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_pinterest_checkout_value_in_micro_dollar"],
                                        "src_total_search": mapped_delivery_df["src_total_search"],
                                        "src_total_search_desktop_action_to_desktop_conversion": mapped_delivery_df["src_total_search_desktop_action_to_desktop_conversion"],
                                        "src_total_search_desktop_action_to_mobile_conversion": mapped_delivery_df["src_total_search_desktop_action_to_mobile_conversion"],
                                        "src_total_search_desktop_action_to_tablet_conversion": mapped_delivery_df["src_total_search_desktop_action_to_tablet_conversion"],
                                        "src_total_search_mobile_action_to_desktop_conversion": mapped_delivery_df["src_total_search_mobile_action_to_desktop_conversion"],
                                        "src_total_search_mobile_action_to_mobile_conversion": mapped_delivery_df["src_total_search_mobile_action_to_mobile_conversion"],
                                        "src_total_search_mobile_action_to_tablet_conversion": mapped_delivery_df["src_total_search_mobile_action_to_tablet_conversion"],
                                        "src_total_search_tablet_action_to_desktop_conversion": mapped_delivery_df["src_total_search_tablet_action_to_desktop_conversion"],
                                        "src_total_search_tablet_action_to_mobile_conversion": mapped_delivery_df["src_total_search_tablet_action_to_mobile_conversion"],
                                        "src_total_search_tablet_action_to_tablet_conversion": mapped_delivery_df["src_total_search_tablet_action_to_tablet_conversion"],
                                        "src_total_search_value_in_micro_dollar": mapped_delivery_df["src_total_search_value_in_micro_dollar"],
                                        "src_total_signup": mapped_delivery_df["src_total_signup"],
                                        "src_total_signup_desktop_action_to_desktop_conversion": mapped_delivery_df["src_total_signup_desktop_action_to_desktop_conversion"],
                                        "src_total_signup_desktop_action_to_mobile_conversion": mapped_delivery_df["src_total_signup_desktop_action_to_mobile_conversion"],
                                        "src_total_signup_desktop_action_to_tablet_conversion": mapped_delivery_df["src_total_signup_desktop_action_to_tablet_conversion"],
                                        "src_total_signup_mobile_action_to_desktop_conversion": mapped_delivery_df["src_total_signup_mobile_action_to_desktop_conversion"],
                                        "src_total_signup_mobile_action_to_mobile_conversion": mapped_delivery_df["src_total_signup_mobile_action_to_mobile_conversion"],
                                        "src_total_signup_mobile_action_to_tablet_conversion": mapped_delivery_df["src_total_signup_mobile_action_to_tablet_conversion"],
                                        "src_total_signup_tablet_action_to_desktop_conversion": mapped_delivery_df["src_total_signup_tablet_action_to_desktop_conversion"],
                                        "src_total_signup_tablet_action_to_mobile_conversion": mapped_delivery_df["src_total_signup_tablet_action_to_mobile_conversion"],
                                        "src_total_signup_tablet_action_to_tablet_conversion": mapped_delivery_df["src_total_signup_tablet_action_to_tablet_conversion"],
                                        "src_total_signup_value_in_micro_dollar": mapped_delivery_df["src_total_signup_value_in_micro_dollar"],
                                        "src_total_unknown_desktop_action_to_desktop_conversion": mapped_delivery_df["src_total_unknown_desktop_action_to_desktop_conversion"],
                                        "src_total_unknown_desktop_action_to_mobile_conversion": mapped_delivery_df["src_total_unknown_desktop_action_to_mobile_conversion"],
                                        "src_total_unknown_desktop_action_to_tablet_conversion": mapped_delivery_df["src_total_unknown_desktop_action_to_tablet_conversion"],
                                        "src_total_unknown_mobile_action_to_desktop_conversion": mapped_delivery_df["src_total_unknown_mobile_action_to_desktop_conversion"],
                                        "src_total_unknown_mobile_action_to_mobile_conversion": mapped_delivery_df["src_total_unknown_mobile_action_to_mobile_conversion"],
                                        "src_total_unknown_mobile_action_to_tablet_conversion": mapped_delivery_df["src_total_unknown_mobile_action_to_tablet_conversion"],
                                        "src_total_unknown_tablet_action_to_desktop_conversion": mapped_delivery_df["src_total_unknown_tablet_action_to_desktop_conversion"],
                                        "src_total_unknown_tablet_action_to_mobile_conversion": mapped_delivery_df["src_total_unknown_tablet_action_to_mobile_conversion"],
                                        "src_total_unknown_tablet_action_to_tablet_conversion": mapped_delivery_df["src_total_unknown_tablet_action_to_tablet_conversion"],
                                        "src_total_video_3sec_views": mapped_delivery_df["src_total_video_3sec_views"],
                                        "src_total_video_avg_watchtime_in_second": mapped_delivery_df["src_total_video_avg_watchtime_in_second"],
                                        "src_total_video_mrc_views": mapped_delivery_df["src_total_video_mrc_views"],
                                        "src_total_video_p0_combined": mapped_delivery_df["src_total_video_p0_combined"],
                                        "src_total_video_p100_complete": mapped_delivery_df["src_total_video_p100_complete"],
                                        "src_total_video_p25_combined": mapped_delivery_df["src_total_video_p25_combined"],
                                        "src_total_video_p50_combined": mapped_delivery_df["src_total_video_p50_combined"],
                                        "src_total_video_p75_combined": mapped_delivery_df["src_total_video_p75_combined"],
                                        "src_total_video_p95_combined": mapped_delivery_df["src_total_video_p95_combined"],
                                        "src_total_view_add_to_cart": mapped_delivery_df["src_total_view_add_to_cart"],
                                        "src_total_view_add_to_cart_quantity": mapped_delivery_df["src_total_view_add_to_cart_quantity"],
                                        "src_total_view_add_to_cart_value_in_micro_dollar": mapped_delivery_df["src_total_view_add_to_cart_value_in_micro_dollar"],
                                        "src_total_view_app_install": mapped_delivery_df["src_total_view_app_install"],
                                        "src_total_view_app_install_value_in_micro_dollar": mapped_delivery_df["src_total_view_app_install_value_in_micro_dollar"],
                                        "src_total_view_category": mapped_delivery_df["src_total_view_category"],
                                        "src_total_view_category_desktop_action_to_desktop_conversion": mapped_delivery_df["src_total_view_category_desktop_action_to_desktop_conversion"],
                                        "src_total_view_category_desktop_action_to_mobile_conversion": mapped_delivery_df["src_total_view_category_desktop_action_to_mobile_conversion"],
                                        "src_total_view_category_desktop_action_to_tablet_conversion": mapped_delivery_df["src_total_view_category_desktop_action_to_tablet_conversion"],
                                        "src_total_view_category_mobile_action_to_desktop_conversion": mapped_delivery_df["src_total_view_category_mobile_action_to_desktop_conversion"],
                                        "src_total_view_category_mobile_action_to_mobile_conversion": mapped_delivery_df["src_total_view_category_mobile_action_to_mobile_conversion"],
                                        "src_total_view_category_mobile_action_to_tablet_conversion": mapped_delivery_df["src_total_view_category_mobile_action_to_tablet_conversion"],
                                        "src_total_view_category_tablet_action_to_desktop_conversion": mapped_delivery_df["src_total_view_category_tablet_action_to_desktop_conversion"],
                                        "src_total_view_category_tablet_action_to_mobile_conversion": mapped_delivery_df["src_total_view_category_tablet_action_to_mobile_conversion"],
                                        "src_total_view_category_tablet_action_to_tablet_conversion": mapped_delivery_df["src_total_view_category_tablet_action_to_tablet_conversion"],
                                        "src_total_view_category_value_in_micro_dollar": mapped_delivery_df["src_total_view_category_value_in_micro_dollar"],
                                        "src_total_view_checkout": mapped_delivery_df["src_total_view_checkout"],
                                        "src_total_view_checkout_quantity": mapped_delivery_df["src_total_view_checkout_quantity"],
                                        "src_total_view_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_view_checkout_value_in_micro_dollar"],
                                        "src_total_view_custom": mapped_delivery_df["src_total_view_custom"],
                                        "src_total_view_custom_quantity": mapped_delivery_df["src_total_view_custom_quantity"],
                                        "src_total_view_custom_value_in_micro_dollar": mapped_delivery_df["src_total_view_custom_value_in_micro_dollar"],
                                        "src_total_view_lead": mapped_delivery_df["src_total_view_lead"],
                                        "src_total_view_lead_quantity": mapped_delivery_df["src_total_view_lead_quantity"],
                                        "src_total_view_lead_value_in_micro_dollar": mapped_delivery_df["src_total_view_lead_value_in_micro_dollar"],
                                        "src_total_view_page_visit": mapped_delivery_df["src_total_view_page_visit"],
                                        "src_total_view_page_visit_quantity": mapped_delivery_df["src_total_view_page_visit_quantity"],
                                        "src_total_view_page_visit_value_in_micro_dollar": mapped_delivery_df["src_total_view_page_visit_value_in_micro_dollar"],
                                        "src_total_view_search": mapped_delivery_df["src_total_view_search"],
                                        "src_total_view_search_quantity": mapped_delivery_df["src_total_view_search_quantity"],
                                        "src_total_view_search_value_in_micro_dollar": mapped_delivery_df["src_total_view_search_value_in_micro_dollar"],
                                        "src_total_view_signup": mapped_delivery_df["src_total_view_signup"],
                                        "src_total_view_signup_quantity": mapped_delivery_df["src_total_view_signup_quantity"],
                                        "src_total_view_signup_value_in_micro_dollar": mapped_delivery_df["src_total_view_signup_value_in_micro_dollar"],
                                        "src_total_view_unknown": mapped_delivery_df["src_total_view_unknown"],
                                        "src_total_view_unknown_quantity": mapped_delivery_df["src_total_view_unknown_quantity"],
                                        "src_total_view_unknown_value_in_micro_dollar": mapped_delivery_df["src_total_view_unknown_value_in_micro_dollar"],
                                        "src_total_view_view_category": mapped_delivery_df["src_total_view_view_category"],
                                        "src_total_view_view_category_quantity": mapped_delivery_df["src_total_view_view_category_quantity"],
                                        "src_total_view_view_category_value_in_micro_dollar": mapped_delivery_df["src_total_view_view_category_value_in_micro_dollar"],
                                        "src_total_view_watch_video": mapped_delivery_df["src_total_view_watch_video"],
                                        "src_total_view_watch_video_quantity": mapped_delivery_df["src_total_view_watch_video_quantity"],
                                        "src_total_view_watch_video_value_in_micro_dollar": mapped_delivery_df["src_total_view_watch_video_value_in_micro_dollar"],
                                        "src_total_watch_video": mapped_delivery_df["src_total_watch_video"],
                                        "src_total_watch_video_desktop_action_to_desktop_conversion": mapped_delivery_df["src_total_watch_video_desktop_action_to_desktop_conversion"],
                                        "src_total_watch_video_desktop_action_to_mobile_conversion": mapped_delivery_df["src_total_watch_video_desktop_action_to_mobile_conversion"],
                                        "src_total_watch_video_desktop_action_to_tablet_conversion": mapped_delivery_df["src_total_watch_video_desktop_action_to_tablet_conversion"],
                                        "src_total_watch_video_mobile_action_to_desktop_conversion": mapped_delivery_df["src_total_watch_video_mobile_action_to_desktop_conversion"],
                                        "src_total_watch_video_mobile_action_to_mobile_conversion": mapped_delivery_df["src_total_watch_video_mobile_action_to_mobile_conversion"],
                                        "src_total_watch_video_mobile_action_to_tablet_conversion": mapped_delivery_df["src_total_watch_video_mobile_action_to_tablet_conversion"],
                                        "src_total_watch_video_tablet_action_to_desktop_conversion": mapped_delivery_df["src_total_watch_video_tablet_action_to_desktop_conversion"],
                                        "src_total_watch_video_tablet_action_to_mobile_conversion": mapped_delivery_df["src_total_watch_video_tablet_action_to_mobile_conversion"],
                                        "src_total_watch_video_tablet_action_to_tablet_conversion": mapped_delivery_df["src_total_watch_video_tablet_action_to_tablet_conversion"],
                                        "src_total_watch_video_value_in_micro_dollar": mapped_delivery_df["src_total_watch_video_value_in_micro_dollar"],
                                        "src_total_web_add_to_cart": mapped_delivery_df["src_total_web_add_to_cart"],
                                        "src_total_web_add_to_cart_value_in_micro_dollar": mapped_delivery_df["src_total_web_add_to_cart_value_in_micro_dollar"],
                                        "src_total_web_checkout": mapped_delivery_df["src_total_web_checkout"],
                                        "src_total_web_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_web_checkout_value_in_micro_dollar"],
                                        "src_total_web_click_add_to_cart": mapped_delivery_df["src_total_web_click_add_to_cart"],
                                        "src_total_web_click_add_to_cart_value_in_micro_dollar": mapped_delivery_df["src_total_web_click_add_to_cart_value_in_micro_dollar"],
                                        "src_total_web_click_checkout": mapped_delivery_df["src_total_web_click_checkout"],
                                        "src_total_web_click_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_web_click_checkout_value_in_micro_dollar"],
                                        "src_total_web_click_custom": mapped_delivery_df["src_total_web_click_custom"],
                                        "src_total_web_click_custom_value_in_micro_dollar": mapped_delivery_df["src_total_web_click_custom_value_in_micro_dollar"],
                                        "src_total_web_click_lead": mapped_delivery_df["src_total_web_click_lead"],
                                        "src_total_web_click_lead_value_in_micro_dollar": mapped_delivery_df["src_total_web_click_lead_value_in_micro_dollar"],
                                        "src_total_web_click_page_visit": mapped_delivery_df["src_total_web_click_page_visit"],
                                        "src_total_web_click_page_visit_value_in_micro_dollar": mapped_delivery_df["src_total_web_click_page_visit_value_in_micro_dollar"],
                                        "src_total_web_click_search": mapped_delivery_df["src_total_web_click_search"],
                                        "src_total_web_click_search_value_in_micro_dollar": mapped_delivery_df["src_total_web_click_search_value_in_micro_dollar"],
                                        "src_total_web_click_signup": mapped_delivery_df["src_total_web_click_signup"],
                                        "src_total_web_click_signup_value_in_micro_dollar": mapped_delivery_df["src_total_web_click_signup_value_in_micro_dollar"],
                                        "src_total_web_click_unknown": mapped_delivery_df["src_total_web_click_unknown"],
                                        "src_total_web_click_unknown_value_in_micro_dollar": mapped_delivery_df["src_total_web_click_unknown_value_in_micro_dollar"],
                                        "src_total_web_click_view_category": mapped_delivery_df["src_total_web_click_view_category"],
                                        "src_total_web_click_view_category_value_in_micro_dollar": mapped_delivery_df["src_total_web_click_view_category_value_in_micro_dollar"],
                                        "src_total_web_click_watch_video": mapped_delivery_df["src_total_web_click_watch_video"],
                                        "src_total_web_click_watch_video_value_in_micro_dollar": mapped_delivery_df["src_total_web_click_watch_video_value_in_micro_dollar"],
                                        "src_total_web_custom": mapped_delivery_df["src_total_web_custom"],
                                        "src_total_web_custom_value_in_micro_dollar": mapped_delivery_df["src_total_web_custom_value_in_micro_dollar"],
                                        "src_total_web_engagement_add_to_cart": mapped_delivery_df["src_total_web_engagement_add_to_cart"],
                                        "src_total_web_engagement_add_to_cart_value_in_micro_dollar": mapped_delivery_df["src_total_web_engagement_add_to_cart_value_in_micro_dollar"],
                                        "src_total_web_engagement_checkout": mapped_delivery_df["src_total_web_engagement_checkout"],
                                        "src_total_web_engagement_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_web_engagement_checkout_value_in_micro_dollar"],
                                        "src_total_web_engagement_custom": mapped_delivery_df["src_total_web_engagement_custom"],
                                        "src_total_web_engagement_custom_value_in_micro_dollar": mapped_delivery_df["src_total_web_engagement_custom_value_in_micro_dollar"],
                                        "src_total_web_engagement_lead": mapped_delivery_df["src_total_web_engagement_lead"],
                                        "src_total_web_engagement_lead_value_in_micro_dollar": mapped_delivery_df["src_total_web_engagement_lead_value_in_micro_dollar"],
                                        "src_total_web_engagement_page_visit": mapped_delivery_df["src_total_web_engagement_page_visit"],
                                        "src_total_web_engagement_page_visit_value_in_micro_dollar": mapped_delivery_df["src_total_web_engagement_page_visit_value_in_micro_dollar"],
                                        "src_total_web_engagement_search": mapped_delivery_df["src_total_web_engagement_search"],
                                        "src_total_web_engagement_search_value_in_micro_dollar": mapped_delivery_df["src_total_web_engagement_search_value_in_micro_dollar"],
                                        "src_total_web_engagement_signup": mapped_delivery_df["src_total_web_engagement_signup"],
                                        "src_total_web_engagement_signup_value_in_micro_dollar": mapped_delivery_df["src_total_web_engagement_signup_value_in_micro_dollar"],
                                        "src_total_web_engagement_unknown": mapped_delivery_df["src_total_web_engagement_unknown"],
                                        "src_total_web_engagement_unknown_value_in_micro_dollar": mapped_delivery_df["src_total_web_engagement_unknown_value_in_micro_dollar"],
                                        "src_total_web_engagement_view_category": mapped_delivery_df["src_total_web_engagement_view_category"],
                                        "src_total_web_engagement_view_category_value_in_micro_dollar": mapped_delivery_df["src_total_web_engagement_view_category_value_in_micro_dollar"],
                                        "src_total_web_engagement_watch_video": mapped_delivery_df["src_total_web_engagement_watch_video"],
                                        "src_total_web_engagement_watch_video_value_in_micro_dollar": mapped_delivery_df["src_total_web_engagement_watch_video_value_in_micro_dollar"],
                                        "src_total_web_lead": mapped_delivery_df["src_total_web_lead"],
                                        "src_total_web_lead_value_in_micro_dollar": mapped_delivery_df["src_total_web_lead_value_in_micro_dollar"],
                                        "src_total_web_page_visit": mapped_delivery_df["src_total_web_page_visit"],
                                        "src_total_web_page_visit_value_in_micro_dollar": mapped_delivery_df["src_total_web_page_visit_value_in_micro_dollar"],
                                        "src_total_web_search": mapped_delivery_df["src_total_web_search"],
                                        "src_total_web_search_value_in_micro_dollar": mapped_delivery_df["src_total_web_search_value_in_micro_dollar"],
                                        "src_total_web_sessions": mapped_delivery_df["src_total_web_sessions"],
                                        "src_total_web_signup": mapped_delivery_df["src_total_web_signup"],
                                        "src_total_web_signup_value_in_micro_dollar": mapped_delivery_df["src_total_web_signup_value_in_micro_dollar"],
                                        "src_total_web_unknown": mapped_delivery_df["src_total_web_unknown"],
                                        "src_total_web_unknown_value_in_micro_dollar": mapped_delivery_df["src_total_web_unknown_value_in_micro_dollar"],
                                        "src_total_web_view_add_to_cart": mapped_delivery_df["src_total_web_view_add_to_cart"],
                                        "src_total_web_view_add_to_cart_value_in_micro_dollar": mapped_delivery_df["src_total_web_view_add_to_cart_value_in_micro_dollar"],
                                        "src_total_web_view_category": mapped_delivery_df["src_total_web_view_category"],
                                        "src_total_web_view_category_value_in_micro_dollar": mapped_delivery_df["src_total_web_view_category_value_in_micro_dollar"],
                                        "src_total_web_view_checkout": mapped_delivery_df["src_total_web_view_checkout"],
                                        "src_total_web_view_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_web_view_checkout_value_in_micro_dollar"],
                                        "src_total_web_view_custom": mapped_delivery_df["src_total_web_view_custom"],
                                        "src_total_web_view_custom_value_in_micro_dollar": mapped_delivery_df["src_total_web_view_custom_value_in_micro_dollar"],
                                        "src_total_web_view_lead": mapped_delivery_df["src_total_web_view_lead"],
                                        "src_total_web_view_lead_value_in_micro_dollar": mapped_delivery_df["src_total_web_view_lead_value_in_micro_dollar"],
                                        "src_total_web_view_page_visit": mapped_delivery_df["src_total_web_view_page_visit"],
                                        "src_total_web_view_page_visit_value_in_micro_dollar": mapped_delivery_df["src_total_web_view_page_visit_value_in_micro_dollar"],
                                        "src_total_web_view_search": mapped_delivery_df["src_total_web_view_search"],
                                        "src_total_web_view_search_value_in_micro_dollar": mapped_delivery_df["src_total_web_view_search_value_in_micro_dollar"],
                                        "src_total_web_view_signup": mapped_delivery_df["src_total_web_view_signup"],
                                        "src_total_web_view_signup_value_in_micro_dollar": mapped_delivery_df["src_total_web_view_signup_value_in_micro_dollar"],
                                        "src_total_web_view_unknown": mapped_delivery_df["src_total_web_view_unknown"],
                                        "src_total_web_view_unknown_value_in_micro_dollar": mapped_delivery_df["src_total_web_view_unknown_value_in_micro_dollar"],
                                        "src_total_web_view_view_category": mapped_delivery_df["src_total_web_view_view_category"],
                                        "src_total_web_view_view_category_value_in_micro_dollar": mapped_delivery_df["src_total_web_view_view_category_value_in_micro_dollar"],
                                        "src_total_web_view_watch_video": mapped_delivery_df["src_total_web_view_watch_video"],
                                        "src_total_web_view_watch_video_value_in_micro_dollar": mapped_delivery_df["src_total_web_view_watch_video_value_in_micro_dollar"],
                                        "src_total_web_watch_video": mapped_delivery_df["src_total_web_watch_video"],
                                        "src_total_web_watch_video_value_in_micro_dollar": mapped_delivery_df["src_total_web_watch_video_value_in_micro_dollar"],
                                        "src_video_3sec_views_1": mapped_delivery_df["src_video_3sec_views_1"],
                                        "src_video_3sec_views_2": mapped_delivery_df["src_video_3sec_views_2"],
                                        "src_video_avg_watchtime_in_second_1": mapped_delivery_df["src_video_avg_watchtime_in_second_1"],
                                        "src_video_avg_watchtime_in_second_2": mapped_delivery_df["src_video_avg_watchtime_in_second_2"],
                                        "src_video_length": mapped_delivery_df["src_video_length"],
                                        "src_video_mrc_views_1": mapped_delivery_df["src_video_mrc_views_1"],
                                        "src_video_mrc_views_2": mapped_delivery_df["src_video_mrc_views_2"],
                                        "src_video_p0_combined_1": mapped_delivery_df["src_video_p0_combined_1"],
                                        "src_video_p0_combined_2": mapped_delivery_df["src_video_p0_combined_2"],
                                        "src_video_p100_complete_1": mapped_delivery_df["src_video_p100_complete_1"],
                                        "src_video_p100_complete_2": mapped_delivery_df["src_video_p100_complete_2"],
                                        "src_video_p25_combined_1": mapped_delivery_df["src_video_p25_combined_1"],
                                        "src_video_p25_combined_2": mapped_delivery_df["src_video_p25_combined_2"],
                                        "src_video_p50_combined_1": mapped_delivery_df["src_video_p50_combined_1"],
                                        "src_video_p50_combined_2": mapped_delivery_df["src_video_p50_combined_2"],
                                        "src_video_p75_combined_1": mapped_delivery_df["src_video_p75_combined_1"],
                                        "src_video_p75_combined_2": mapped_delivery_df["src_video_p75_combined_2"],
                                        "src_video_p95_combined_1": mapped_delivery_df["src_video_p95_combined_1"],
                                        "src_video_p95_combined_2": mapped_delivery_df["src_video_p95_combined_2"],
                                        "src_web_sessions_1": mapped_delivery_df["src_web_sessions_1"],
                                        "src_web_sessions_2": mapped_delivery_df["src_web_sessions_2"],
                                        "data_as_of_ts": mapped_delivery_df["data_as_of_ts"],
                                        "file_name": mapped_delivery_df["file_name"],
                                        "file_row_number": mapped_delivery_df["file_row_number"],
                                        "modified_batch_id": mapped_delivery_df["modified_batch_id"],
                                        "modified_ts": mapped_delivery_df["modified_ts"]
                                    }),
                      F.when_not_matched().insert({
                                        "pinterest_advertiser_id": mapped_delivery_df["pinterest_advertiser_id"],
                                        "pinterest_order_line_id": mapped_delivery_df["pinterest_order_line_id"],
                                        "ad_group_status": mapped_delivery_df["ad_group_status"],
                                        "campaign_managed_status": mapped_delivery_df["campaign_managed_status"],
                                        "src_campaign_lifetime_spend_cap": mapped_delivery_df["src_campaign_lifetime_spend_cap"],
                                        "src_campaign_daily_spend_cap": mapped_delivery_df["src_campaign_daily_spend_cap"],
                                        "src_clickthrough_1": mapped_delivery_df["src_clickthrough_1"],
                                        "src_clickthrough_1_gross": mapped_delivery_df["src_clickthrough_1_gross"],
                                        "src_clickthrough_2": mapped_delivery_df["src_clickthrough_2"],
                                        "src_engagement_1": mapped_delivery_df["src_engagement_1"],
                                        "src_engagement_2": mapped_delivery_df["src_engagement_2"],
                                        "src_idea_pin_product_tag_visit_1": mapped_delivery_df["src_idea_pin_product_tag_visit_1"],
                                        "src_idea_pin_product_tag_visit_2": mapped_delivery_df["src_idea_pin_product_tag_visit_2"],
                                        "src_impression_1": mapped_delivery_df["src_impression_1"],
                                        "src_impression_1_gross": mapped_delivery_df["src_impression_1_gross"],
                                        "src_impression_2": mapped_delivery_df["src_impression_2"],
                                        "src_leads": mapped_delivery_df["src_leads"],
                                        "src_onsite_checkouts_1": mapped_delivery_df["src_onsite_checkouts_1"],
                                        "order_line_name": F.when(mapped_delivery_df["order_line_name"]=='', None).otherwise(mapped_delivery_df["order_line_name"]),
                                        "src_outbound_click_1": mapped_delivery_df["src_outbound_click_1"],
                                        "src_outbound_click_2": mapped_delivery_df["src_outbound_click_2"],
                                        "src_paid_impression": mapped_delivery_df["src_paid_impression"],
                                        "src_quiz_completed": mapped_delivery_df["src_quiz_completed"],
                                        "src_repin_1": mapped_delivery_df["src_repin_1"],
                                        "src_repin_2": mapped_delivery_df["src_repin_2"],
                                        "src_showcase_average_subpage_closeup_per_session": mapped_delivery_df["src_showcase_average_subpage_closeup_per_session"],
                                        "src_showcase_card_thumbnail_swipe_backward": mapped_delivery_df["src_showcase_card_thumbnail_swipe_backward"],
                                        "src_showcase_card_thumbnail_swipe_forward": mapped_delivery_df["src_showcase_card_thumbnail_swipe_forward"],
                                        "src_showcase_pin_clickthrough": mapped_delivery_df["src_showcase_pin_clickthrough"],
                                        "src_showcase_subpage_clickthrough": mapped_delivery_df["src_showcase_subpage_clickthrough"],
                                        "src_showcase_subpage_closeup": mapped_delivery_df["src_showcase_subpage_closeup"],
                                        "src_showcase_subpage_impression": mapped_delivery_df["src_showcase_subpage_impression"],
                                        "src_showcase_subpage_repin": mapped_delivery_df["src_showcase_subpage_repin"],
                                        "src_showcase_subpage_swipe_left": mapped_delivery_df["src_showcase_subpage_swipe_left"],
                                        "src_showcase_subpage_swipe_right": mapped_delivery_df["src_showcase_subpage_swipe_right"],
                                        "src_showcase_subpin_clickthrough": mapped_delivery_df["src_showcase_subpin_clickthrough"],
                                        "src_showcase_subpin_impression": mapped_delivery_df["src_showcase_subpin_impression"],
                                        "src_showcase_subpin_repin": mapped_delivery_df["src_showcase_subpin_repin"],
                                        "src_showcase_subpin_swipe_left": mapped_delivery_df["src_showcase_subpin_swipe_left"],
                                        "src_showcase_subpin_swipe_right": mapped_delivery_df["src_showcase_subpin_swipe_right"],
                                        "src_spend_in_dollar": mapped_delivery_df["src_spend_in_dollar"],
                                        "src_spend_in_micro_dollar": mapped_delivery_df["src_spend_in_micro_dollar"],
                                        "src_total_add_to_cart": mapped_delivery_df["src_total_add_to_cart"],
                                        "src_total_add_to_cart_desktop_action_to_desktop_conversion": mapped_delivery_df["src_total_add_to_cart_desktop_action_to_desktop_conversion"],
                                        "src_total_add_to_cart_desktop_action_to_mobile_conversion": mapped_delivery_df["src_total_add_to_cart_desktop_action_to_mobile_conversion"],
                                        "src_total_add_to_cart_desktop_action_to_tablet_conversion": mapped_delivery_df["src_total_add_to_cart_desktop_action_to_tablet_conversion"],
                                        "src_total_add_to_cart_mobile_action_to_desktop_conversion": mapped_delivery_df["src_total_add_to_cart_mobile_action_to_desktop_conversion"],
                                        "src_total_add_to_cart_mobile_action_to_mobile_conversion": mapped_delivery_df["src_total_add_to_cart_mobile_action_to_mobile_conversion"],
                                        "src_total_add_to_cart_mobile_action_to_tablet_conversion": mapped_delivery_df["src_total_add_to_cart_mobile_action_to_tablet_conversion"],
                                        "src_total_add_to_cart_tablet_action_to_desktop_conversion": mapped_delivery_df["src_total_add_to_cart_tablet_action_to_desktop_conversion"],
                                        "src_total_add_to_cart_tablet_action_to_mobile_conversion": mapped_delivery_df["src_total_add_to_cart_tablet_action_to_mobile_conversion"],
                                        "src_total_add_to_cart_tablet_action_to_tablet_conversion": mapped_delivery_df["src_total_add_to_cart_tablet_action_to_tablet_conversion"],
                                        "src_total_add_to_cart_value_in_micro_dollar": mapped_delivery_df["src_total_add_to_cart_value_in_micro_dollar"],
                                        "src_total_app_install": mapped_delivery_df["src_total_app_install"],
                                        "src_total_app_install_desktop_action_to_desktop_conversion": mapped_delivery_df["src_total_app_install_desktop_action_to_desktop_conversion"],
                                        "src_total_app_install_desktop_action_to_mobile_conversion": mapped_delivery_df["src_total_app_install_desktop_action_to_mobile_conversion"],
                                        "src_total_app_install_desktop_action_to_tablet_conversion": mapped_delivery_df["src_total_app_install_desktop_action_to_tablet_conversion"],
                                        "src_total_app_install_mobile_action_to_desktop_conversion": mapped_delivery_df["src_total_app_install_mobile_action_to_desktop_conversion"],
                                        "src_total_app_install_mobile_action_to_mobile_conversion": mapped_delivery_df["src_total_app_install_mobile_action_to_mobile_conversion"],
                                        "src_total_app_install_mobile_action_to_tablet_conversion": mapped_delivery_df["src_total_app_install_mobile_action_to_tablet_conversion"],
                                        "src_total_app_install_tablet_action_to_desktop_conversion": mapped_delivery_df["src_total_app_install_tablet_action_to_desktop_conversion"],
                                        "src_total_app_install_tablet_action_to_mobile_conversion": mapped_delivery_df["src_total_app_install_tablet_action_to_mobile_conversion"],
                                        "src_total_app_install_tablet_action_to_tablet_conversion": mapped_delivery_df["src_total_app_install_tablet_action_to_tablet_conversion"],
                                        "src_total_app_install_value_in_micro_dollar": mapped_delivery_df["src_total_app_install_value_in_micro_dollar"],
                                        "src_total_checkout": mapped_delivery_df["src_total_checkout"],
                                        "src_total_checkout_desktop_action_to_desktop_conversion": mapped_delivery_df["src_total_checkout_desktop_action_to_desktop_conversion"],
                                        "src_total_checkout_desktop_action_to_mobile_conversion": mapped_delivery_df["src_total_checkout_desktop_action_to_mobile_conversion"],
                                        "src_total_checkout_desktop_action_to_tablet_conversion": mapped_delivery_df["src_total_checkout_desktop_action_to_tablet_conversion"],
                                        "src_total_checkout_mobile_action_to_desktop_conversion": mapped_delivery_df["src_total_checkout_mobile_action_to_desktop_conversion"],
                                        "src_total_checkout_mobile_action_to_mobile_conversion": mapped_delivery_df["src_total_checkout_mobile_action_to_mobile_conversion"],
                                        "src_total_checkout_mobile_action_to_tablet_conversion": mapped_delivery_df["src_total_checkout_mobile_action_to_tablet_conversion"],
                                        "src_total_checkout_quantity": mapped_delivery_df["src_total_checkout_quantity"],
                                        "src_total_checkout_tablet_action_to_desktop_conversion": mapped_delivery_df["src_total_checkout_tablet_action_to_desktop_conversion"],
                                        "src_total_checkout_tablet_action_to_mobile_conversion": mapped_delivery_df["src_total_checkout_tablet_action_to_mobile_conversion"],
                                        "src_total_checkout_tablet_action_to_tablet_conversion": mapped_delivery_df["src_total_checkout_tablet_action_to_tablet_conversion"],
                                        "src_total_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_checkout_value_in_micro_dollar"],
                                        "src_total_click_add_to_cart": mapped_delivery_df["src_total_click_add_to_cart"],
                                        "src_total_click_add_to_cart_quantity": mapped_delivery_df["src_total_click_add_to_cart_quantity"],
                                        "src_total_click_add_to_cart_value_in_micro_dollar": mapped_delivery_df["src_total_click_add_to_cart_value_in_micro_dollar"],
                                        "src_total_click_app_install": mapped_delivery_df["src_total_click_app_install"],
                                        "src_total_click_app_install_value_in_micro_dollar": mapped_delivery_df["src_total_click_app_install_value_in_micro_dollar"],
                                        "src_total_click_checkout": mapped_delivery_df["src_total_click_checkout"],
                                        "src_total_click_checkout_quantity": mapped_delivery_df["src_total_click_checkout_quantity"],
                                        "src_total_click_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_click_checkout_value_in_micro_dollar"],
                                        "src_total_click_custom": mapped_delivery_df["src_total_click_custom"],
                                        "src_total_click_custom_quantity": mapped_delivery_df["src_total_click_custom_quantity"],
                                        "src_total_click_custom_value_in_micro_dollar": mapped_delivery_df["src_total_click_custom_value_in_micro_dollar"],
                                        "src_total_click_lead": mapped_delivery_df["src_total_click_lead"],
                                        "src_total_click_lead_quantity": mapped_delivery_df["src_total_click_lead_quantity"],
                                        "src_total_click_lead_value_in_micro_dollar": mapped_delivery_df["src_total_click_lead_value_in_micro_dollar"],
                                        "src_total_click_page_visit": mapped_delivery_df["src_total_click_page_visit"],
                                        "src_total_click_page_visit_quantity": mapped_delivery_df["src_total_click_page_visit_quantity"],
                                        "src_total_click_page_visit_value_in_micro_dollar": mapped_delivery_df["src_total_click_page_visit_value_in_micro_dollar"],
                                        "src_total_click_search": mapped_delivery_df["src_total_click_search"],
                                        "src_total_click_search_quantity": mapped_delivery_df["src_total_click_search_quantity"],
                                        "src_total_click_search_value_in_micro_dollar": mapped_delivery_df["src_total_click_search_value_in_micro_dollar"],
                                        "src_total_click_signup": mapped_delivery_df["src_total_click_signup"],
                                        "src_total_click_signup_quantity": mapped_delivery_df["src_total_click_signup_quantity"],
                                        "src_total_click_signup_value_in_micro_dollar": mapped_delivery_df["src_total_click_signup_value_in_micro_dollar"],
                                        "src_total_clickthrough": mapped_delivery_df["src_total_clickthrough"],
                                        "src_total_click_unknown": mapped_delivery_df["src_total_click_unknown"],
                                        "src_total_click_unknown_quantity": mapped_delivery_df["src_total_click_unknown_quantity"],
                                        "src_total_click_unknown_value_in_micro_dollar": mapped_delivery_df["src_total_click_unknown_value_in_micro_dollar"],
                                        "src_total_click_view_category": mapped_delivery_df["src_total_click_view_category"],
                                        "src_total_click_view_category_quantity": mapped_delivery_df["src_total_click_view_category_quantity"],
                                        "src_total_click_view_category_value_in_micro_dollar": mapped_delivery_df["src_total_click_view_category_value_in_micro_dollar"],
                                        "src_total_click_watch_video": mapped_delivery_df["src_total_click_watch_video"],
                                        "src_total_click_watch_video_quantity": mapped_delivery_df["src_total_click_watch_video_quantity"],
                                        "src_total_click_watch_video_value_in_micro_dollar": mapped_delivery_df["src_total_click_watch_video_value_in_micro_dollar"],
                                        "src_total_conversions": mapped_delivery_df["src_total_conversions"],
                                        "src_total_conversions_quantity": mapped_delivery_df["src_total_conversions_quantity"],
                                        "src_total_conversions_value_in_micro_dollar": mapped_delivery_df["src_total_conversions_value_in_micro_dollar"],
                                        "src_total_custom": mapped_delivery_df["src_total_custom"],
                                        "src_total_custom_desktop_action_to_desktop_conversion": mapped_delivery_df["src_total_custom_desktop_action_to_desktop_conversion"],
                                        "src_total_custom_desktop_action_to_mobile_conversion": mapped_delivery_df["src_total_custom_desktop_action_to_mobile_conversion"],
                                        "src_total_custom_desktop_action_to_tablet_conversion": mapped_delivery_df["src_total_custom_desktop_action_to_tablet_conversion"],
                                        "src_total_custom_mobile_action_to_desktop_conversion": mapped_delivery_df["src_total_custom_mobile_action_to_desktop_conversion"],
                                        "src_total_custom_mobile_action_to_mobile_conversion": mapped_delivery_df["src_total_custom_mobile_action_to_mobile_conversion"],
                                        "src_total_custom_mobile_action_to_tablet_conversion": mapped_delivery_df["src_total_custom_mobile_action_to_tablet_conversion"],
                                        "src_total_custom_tablet_action_to_desktop_conversion": mapped_delivery_df["src_total_custom_tablet_action_to_desktop_conversion"],
                                        "src_total_custom_tablet_action_to_mobile_conversion": mapped_delivery_df["src_total_custom_tablet_action_to_mobile_conversion"],
                                        "src_total_custom_tablet_action_to_tablet_conversion": mapped_delivery_df["src_total_custom_tablet_action_to_tablet_conversion"],
                                        "src_total_custom_value_in_micro_dollar": mapped_delivery_df["src_total_custom_value_in_micro_dollar"],
                                        "src_total_destination_views": mapped_delivery_df["src_total_destination_views"],
                                        "src_total_engagement": mapped_delivery_df["src_total_engagement"],
                                        "src_total_engagement_add_to_cart": mapped_delivery_df["src_total_engagement_add_to_cart"],
                                        "src_total_engagement_add_to_cart_quantity": mapped_delivery_df["src_total_engagement_add_to_cart_quantity"],
                                        "src_total_engagement_add_to_cart_value_in_micro_dollar": mapped_delivery_df["src_total_engagement_add_to_cart_value_in_micro_dollar"],
                                        "src_total_engagement_app_install": mapped_delivery_df["src_total_engagement_app_install"],
                                        "src_total_engagement_app_install_value_in_micro_dollar": mapped_delivery_df["src_total_engagement_app_install_value_in_micro_dollar"],
                                        "src_total_engagement_checkout": mapped_delivery_df["src_total_engagement_checkout"],
                                        "src_total_engagement_checkout_quantity": mapped_delivery_df["src_total_engagement_checkout_quantity"],
                                        "src_total_engagement_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_engagement_checkout_value_in_micro_dollar"],
                                        "src_total_engagement_custom": mapped_delivery_df["src_total_engagement_custom"],
                                        "src_total_engagement_custom_quantity": mapped_delivery_df["src_total_engagement_custom_quantity"],
                                        "src_total_engagement_custom_value_in_micro_dollar": mapped_delivery_df["src_total_engagement_custom_value_in_micro_dollar"],
                                        "src_total_engagement_lead": mapped_delivery_df["src_total_engagement_lead"],
                                        "src_total_engagement_lead_quantity": mapped_delivery_df["src_total_engagement_lead_quantity"],
                                        "src_total_engagement_lead_value_in_micro_dollar": mapped_delivery_df["src_total_engagement_lead_value_in_micro_dollar"],
                                        "src_total_engagement_page_visit": mapped_delivery_df["src_total_engagement_page_visit"],
                                        "src_total_engagement_page_visit_quantity": mapped_delivery_df["src_total_engagement_page_visit_quantity"],
                                        "src_total_engagement_page_visit_value_in_micro_dollar": mapped_delivery_df["src_total_engagement_page_visit_value_in_micro_dollar"],
                                        "src_total_engagement_search": mapped_delivery_df["src_total_engagement_search"],
                                        "src_total_engagement_search_quantity": mapped_delivery_df["src_total_engagement_search_quantity"],
                                        "src_total_engagement_search_value_in_micro_dollar": mapped_delivery_df["src_total_engagement_search_value_in_micro_dollar"],
                                        "src_total_engagement_signup": mapped_delivery_df["src_total_engagement_signup"],
                                        "src_total_engagement_signup_quantity": mapped_delivery_df["src_total_engagement_signup_quantity"],
                                        "src_total_engagement_signup_value_in_micro_dollar": mapped_delivery_df["src_total_engagement_signup_value_in_micro_dollar"],
                                        "src_total_engagement_unknown": mapped_delivery_df["src_total_engagement_unknown"],
                                        "src_total_engagement_unknown_quantity": mapped_delivery_df["src_total_engagement_unknown_quantity"],
                                        "src_total_engagement_unknown_value_in_micro_dollar": mapped_delivery_df["src_total_engagement_unknown_value_in_micro_dollar"],
                                        "src_total_engagement_view_category": mapped_delivery_df["src_total_engagement_view_category"],
                                        "src_total_engagement_view_category_quantity": mapped_delivery_df["src_total_engagement_view_category_quantity"],
                                        "src_total_engagement_view_category_value_in_micro_dollar": mapped_delivery_df["src_total_engagement_view_category_value_in_micro_dollar"],
                                        "src_total_engagement_watch_video": mapped_delivery_df["src_total_engagement_watch_video"],
                                        "src_total_engagement_watch_video_quantity": mapped_delivery_df["src_total_engagement_watch_video_quantity"],
                                        "src_total_engagement_watch_video_value_in_micro_dollar": mapped_delivery_df["src_total_engagement_watch_video_value_in_micro_dollar"],
                                        "src_total_idea_pin_product_tag_visit": mapped_delivery_df["src_total_idea_pin_product_tag_visit"],
                                        "src_total_impression": mapped_delivery_df["src_total_impression"],
                                        "src_total_inapp_add_to_cart": mapped_delivery_df["src_total_inapp_add_to_cart"],
                                        "src_total_inapp_add_to_cart_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_add_to_cart_value_in_micro_dollar"],
                                        "src_total_inapp_app_install": mapped_delivery_df["src_total_inapp_app_install"],
                                        "src_total_inapp_app_install_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_app_install_value_in_micro_dollar"],
                                        "src_total_inapp_checkout": mapped_delivery_df["src_total_inapp_checkout"],
                                        "src_total_inapp_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_checkout_value_in_micro_dollar"],
                                        "src_total_inapp_click_add_to_cart": mapped_delivery_df["src_total_inapp_click_add_to_cart"],
                                        "src_total_inapp_click_add_to_cart_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_click_add_to_cart_value_in_micro_dollar"],
                                        "src_total_inapp_click_app_install": mapped_delivery_df["src_total_inapp_click_app_install"],
                                        "src_total_inapp_click_app_install_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_click_app_install_value_in_micro_dollar"],
                                        "src_total_inapp_click_checkout": mapped_delivery_df["src_total_inapp_click_checkout"],
                                        "src_total_inapp_click_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_click_checkout_value_in_micro_dollar"],
                                        "src_total_inapp_click_search": mapped_delivery_df["src_total_inapp_click_search"],
                                        "src_total_inapp_click_search_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_click_search_value_in_micro_dollar"],
                                        "src_total_inapp_click_signup": mapped_delivery_df["src_total_inapp_click_signup"],
                                        "src_total_inapp_click_signup_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_click_signup_value_in_micro_dollar"],
                                        "src_total_inapp_click_unknown": mapped_delivery_df["src_total_inapp_click_unknown"],
                                        "src_total_inapp_click_unknown_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_click_unknown_value_in_micro_dollar"],
                                        "src_total_inapp_engagement_add_to_cart": mapped_delivery_df["src_total_inapp_engagement_add_to_cart"],
                                        "src_total_inapp_engagement_add_to_cart_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_engagement_add_to_cart_value_in_micro_dollar"],
                                        "src_total_inapp_engagement_app_install": mapped_delivery_df["src_total_inapp_engagement_app_install"],
                                        "src_total_inapp_engagement_app_install_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_engagement_app_install_value_in_micro_dollar"],
                                        "src_total_inapp_engagement_checkout": mapped_delivery_df["src_total_inapp_engagement_checkout"],
                                        "src_total_inapp_engagement_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_engagement_checkout_value_in_micro_dollar"],
                                        "src_total_inapp_engagement_search": mapped_delivery_df["src_total_inapp_engagement_search"],
                                        "src_total_inapp_engagement_search_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_engagement_search_value_in_micro_dollar"],
                                        "src_total_inapp_engagement_signup": mapped_delivery_df["src_total_inapp_engagement_signup"],
                                        "src_total_inapp_engagement_signup_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_engagement_signup_value_in_micro_dollar"],
                                        "src_total_inapp_engagement_unknown": mapped_delivery_df["src_total_inapp_engagement_unknown"],
                                        "src_total_inapp_engagement_unknown_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_engagement_unknown_value_in_micro_dollar"],
                                        "src_total_inapp_search": mapped_delivery_df["src_total_inapp_search"],
                                        "src_total_inapp_search_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_search_value_in_micro_dollar"],
                                        "src_total_inapp_signup": mapped_delivery_df["src_total_inapp_signup"],
                                        "src_total_inapp_signup_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_signup_value_in_micro_dollar"],
                                        "src_total_inapp_unknown": mapped_delivery_df["src_total_inapp_unknown"],
                                        "src_total_inapp_unknown_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_unknown_value_in_micro_dollar"],
                                        "src_total_inapp_view_add_to_cart": mapped_delivery_df["src_total_inapp_view_add_to_cart"],
                                        "src_total_inapp_view_add_to_cart_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_view_add_to_cart_value_in_micro_dollar"],
                                        "src_total_inapp_view_app_install": mapped_delivery_df["src_total_inapp_view_app_install"],
                                        "src_total_inapp_view_app_install_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_view_app_install_value_in_micro_dollar"],
                                        "src_total_inapp_view_checkout": mapped_delivery_df["src_total_inapp_view_checkout"],
                                        "src_total_inapp_view_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_view_checkout_value_in_micro_dollar"],
                                        "src_total_inapp_view_search": mapped_delivery_df["src_total_inapp_view_search"],
                                        "src_total_inapp_view_search_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_view_search_value_in_micro_dollar"],
                                        "src_total_inapp_view_signup": mapped_delivery_df["src_total_inapp_view_signup"],
                                        "src_total_inapp_view_signup_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_view_signup_value_in_micro_dollar"],
                                        "src_total_inapp_view_unknown": mapped_delivery_df["src_total_inapp_view_unknown"],
                                        "src_total_inapp_view_unknown_value_in_micro_dollar": mapped_delivery_df["src_total_inapp_view_unknown_value_in_micro_dollar"],
                                        "src_total_lead": mapped_delivery_df["src_total_lead"],
                                        "src_total_lead_desktop_action_to_desktop_conversion": mapped_delivery_df["src_total_lead_desktop_action_to_desktop_conversion"],
                                        "src_total_lead_desktop_action_to_mobile_conversion": mapped_delivery_df["src_total_lead_desktop_action_to_mobile_conversion"],
                                        "src_total_lead_desktop_action_to_tablet_conversion": mapped_delivery_df["src_total_lead_desktop_action_to_tablet_conversion"],
                                        "src_total_lead_mobile_action_to_desktop_conversion": mapped_delivery_df["src_total_lead_mobile_action_to_desktop_conversion"],
                                        "src_total_lead_mobile_action_to_mobile_conversion": mapped_delivery_df["src_total_lead_mobile_action_to_mobile_conversion"],
                                        "src_total_lead_mobile_action_to_tablet_conversion": mapped_delivery_df["src_total_lead_mobile_action_to_tablet_conversion"],
                                        "src_total_lead_tablet_action_to_desktop_conversion": mapped_delivery_df["src_total_lead_tablet_action_to_desktop_conversion"],
                                        "src_total_lead_tablet_action_to_mobile_conversion": mapped_delivery_df["src_total_lead_tablet_action_to_mobile_conversion"],
                                        "src_total_lead_tablet_action_to_tablet_conversion": mapped_delivery_df["src_total_lead_tablet_action_to_tablet_conversion"],
                                        "src_total_lead_value_in_micro_dollar": mapped_delivery_df["src_total_lead_value_in_micro_dollar"],
                                        "src_total_offline_checkout": mapped_delivery_df["src_total_offline_checkout"],
                                        "src_total_offline_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_offline_checkout_value_in_micro_dollar"],
                                        "src_total_offline_click_checkout": mapped_delivery_df["src_total_offline_click_checkout"],
                                        "src_total_offline_click_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_offline_click_checkout_value_in_micro_dollar"],
                                        "src_total_offline_click_custom": mapped_delivery_df["src_total_offline_click_custom"],
                                        "src_total_offline_click_custom_value_in_micro_dollar": mapped_delivery_df["src_total_offline_click_custom_value_in_micro_dollar"],
                                        "src_total_offline_click_lead": mapped_delivery_df["src_total_offline_click_lead"],
                                        "src_total_offline_click_lead_value_in_micro_dollar": mapped_delivery_df["src_total_offline_click_lead_value_in_micro_dollar"],
                                        "src_total_offline_click_signup": mapped_delivery_df["src_total_offline_click_signup"],
                                        "src_total_offline_click_signup_value_in_micro_dollar": mapped_delivery_df["src_total_offline_click_signup_value_in_micro_dollar"],
                                        "src_total_offline_click_unknown": mapped_delivery_df["src_total_offline_click_unknown"],
                                        "src_total_offline_click_unknown_value_in_micro_dollar": mapped_delivery_df["src_total_offline_click_unknown_value_in_micro_dollar"],
                                        "src_total_offline_custom": mapped_delivery_df["src_total_offline_custom"],
                                        "src_total_offline_custom_value_in_micro_dollar": mapped_delivery_df["src_total_offline_custom_value_in_micro_dollar"],
                                        "src_total_offline_engagement_checkout": mapped_delivery_df["src_total_offline_engagement_checkout"],
                                        "src_total_offline_engagement_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_offline_engagement_checkout_value_in_micro_dollar"],
                                        "src_total_offline_engagement_custom": mapped_delivery_df["src_total_offline_engagement_custom"],
                                        "src_total_offline_engagement_custom_value_in_micro_dollar": mapped_delivery_df["src_total_offline_engagement_custom_value_in_micro_dollar"],
                                        "src_total_offline_engagement_lead": mapped_delivery_df["src_total_offline_engagement_lead"],
                                        "src_total_offline_engagement_lead_value_in_micro_dollar": mapped_delivery_df["src_total_offline_engagement_lead_value_in_micro_dollar"],
                                        "src_total_offline_engagement_signup": mapped_delivery_df["src_total_offline_engagement_signup"],
                                        "src_total_offline_engagement_signup_value_in_micro_dollar": mapped_delivery_df["src_total_offline_engagement_signup_value_in_micro_dollar"],
                                        "src_total_offline_engagement_unknown": mapped_delivery_df["src_total_offline_engagement_unknown"],
                                        "src_total_offline_engagement_unknown_value_in_micro_dollar": mapped_delivery_df["src_total_offline_engagement_unknown_value_in_micro_dollar"],
                                        "src_total_offline_lead": mapped_delivery_df["src_total_offline_lead"],
                                        "src_total_offline_lead_value_in_micro_dollar": mapped_delivery_df["src_total_offline_lead_value_in_micro_dollar"],
                                        "src_total_offline_signup": mapped_delivery_df["src_total_offline_signup"],
                                        "src_total_offline_signup_value_in_micro_dollar": mapped_delivery_df["src_total_offline_signup_value_in_micro_dollar"],
                                        "src_total_offline_unknown": mapped_delivery_df["src_total_offline_unknown"],
                                        "src_total_offline_unknown_value_in_micro_dollar": mapped_delivery_df["src_total_offline_unknown_value_in_micro_dollar"],
                                        "src_total_offline_view_checkout": mapped_delivery_df["src_total_offline_view_checkout"],
                                        "src_total_offline_view_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_offline_view_checkout_value_in_micro_dollar"],
                                        "src_total_offline_view_custom": mapped_delivery_df["src_total_offline_view_custom"],
                                        "src_total_offline_view_custom_value_in_micro_dollar": mapped_delivery_df["src_total_offline_view_custom_value_in_micro_dollar"],
                                        "src_total_offline_view_lead": mapped_delivery_df["src_total_offline_view_lead"],
                                        "src_total_offline_view_lead_value_in_micro_dollar": mapped_delivery_df["src_total_offline_view_lead_value_in_micro_dollar"],
                                        "src_total_offline_view_signup": mapped_delivery_df["src_total_offline_view_signup"],
                                        "src_total_offline_view_signup_value_in_micro_dollar": mapped_delivery_df["src_total_offline_view_signup_value_in_micro_dollar"],
                                        "src_total_offline_view_unknown": mapped_delivery_df["src_total_offline_view_unknown"],
                                        "src_total_offline_view_unknown_value_in_micro_dollar": mapped_delivery_df["src_total_offline_view_unknown_value_in_micro_dollar"],
                                        "src_total_page_visit": mapped_delivery_df["src_total_page_visit"],
                                        "src_total_page_visit_desktop_action_to_desktop_conversion": mapped_delivery_df["src_total_page_visit_desktop_action_to_desktop_conversion"],
                                        "src_total_page_visit_desktop_action_to_mobile_conversion": mapped_delivery_df["src_total_page_visit_desktop_action_to_mobile_conversion"],
                                        "src_total_page_visit_desktop_action_to_tablet_conversion": mapped_delivery_df["src_total_page_visit_desktop_action_to_tablet_conversion"],
                                        "src_total_page_visit_mobile_action_to_desktop_conversion": mapped_delivery_df["src_total_page_visit_mobile_action_to_desktop_conversion"],
                                        "src_total_page_visit_mobile_action_to_mobile_conversion": mapped_delivery_df["src_total_page_visit_mobile_action_to_mobile_conversion"],
                                        "src_total_page_visit_mobile_action_to_tablet_conversion": mapped_delivery_df["src_total_page_visit_mobile_action_to_tablet_conversion"],
                                        "src_total_page_visit_tablet_action_to_desktop_conversion": mapped_delivery_df["src_total_page_visit_tablet_action_to_desktop_conversion"],
                                        "src_total_page_visit_tablet_action_to_mobile_conversion": mapped_delivery_df["src_total_page_visit_tablet_action_to_mobile_conversion"],
                                        "src_total_page_visit_tablet_action_to_tablet_conversion": mapped_delivery_df["src_total_page_visit_tablet_action_to_tablet_conversion"],
                                        "src_total_pinterest_checkout": mapped_delivery_df["src_total_pinterest_checkout"],
                                        "src_total_pinterest_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_pinterest_checkout_value_in_micro_dollar"],
                                        "src_total_search": mapped_delivery_df["src_total_search"],
                                        "src_total_search_desktop_action_to_desktop_conversion": mapped_delivery_df["src_total_search_desktop_action_to_desktop_conversion"],
                                        "src_total_search_desktop_action_to_mobile_conversion": mapped_delivery_df["src_total_search_desktop_action_to_mobile_conversion"],
                                        "src_total_search_desktop_action_to_tablet_conversion": mapped_delivery_df["src_total_search_desktop_action_to_tablet_conversion"],
                                        "src_total_search_mobile_action_to_desktop_conversion": mapped_delivery_df["src_total_search_mobile_action_to_desktop_conversion"],
                                        "src_total_search_mobile_action_to_mobile_conversion": mapped_delivery_df["src_total_search_mobile_action_to_mobile_conversion"],
                                        "src_total_search_mobile_action_to_tablet_conversion": mapped_delivery_df["src_total_search_mobile_action_to_tablet_conversion"],
                                        "src_total_search_tablet_action_to_desktop_conversion": mapped_delivery_df["src_total_search_tablet_action_to_desktop_conversion"],
                                        "src_total_search_tablet_action_to_mobile_conversion": mapped_delivery_df["src_total_search_tablet_action_to_mobile_conversion"],
                                        "src_total_search_tablet_action_to_tablet_conversion": mapped_delivery_df["src_total_search_tablet_action_to_tablet_conversion"],
                                        "src_total_search_value_in_micro_dollar": mapped_delivery_df["src_total_search_value_in_micro_dollar"],
                                        "src_total_signup": mapped_delivery_df["src_total_signup"],
                                        "src_total_signup_desktop_action_to_desktop_conversion": mapped_delivery_df["src_total_signup_desktop_action_to_desktop_conversion"],
                                        "src_total_signup_desktop_action_to_mobile_conversion": mapped_delivery_df["src_total_signup_desktop_action_to_mobile_conversion"],
                                        "src_total_signup_desktop_action_to_tablet_conversion": mapped_delivery_df["src_total_signup_desktop_action_to_tablet_conversion"],
                                        "src_total_signup_mobile_action_to_desktop_conversion": mapped_delivery_df["src_total_signup_mobile_action_to_desktop_conversion"],
                                        "src_total_signup_mobile_action_to_mobile_conversion": mapped_delivery_df["src_total_signup_mobile_action_to_mobile_conversion"],
                                        "src_total_signup_mobile_action_to_tablet_conversion": mapped_delivery_df["src_total_signup_mobile_action_to_tablet_conversion"],
                                        "src_total_signup_tablet_action_to_desktop_conversion": mapped_delivery_df["src_total_signup_tablet_action_to_desktop_conversion"],
                                        "src_total_signup_tablet_action_to_mobile_conversion": mapped_delivery_df["src_total_signup_tablet_action_to_mobile_conversion"],
                                        "src_total_signup_tablet_action_to_tablet_conversion": mapped_delivery_df["src_total_signup_tablet_action_to_tablet_conversion"],
                                        "src_total_signup_value_in_micro_dollar": mapped_delivery_df["src_total_signup_value_in_micro_dollar"],
                                        "src_total_unknown_desktop_action_to_desktop_conversion": mapped_delivery_df["src_total_unknown_desktop_action_to_desktop_conversion"],
                                        "src_total_unknown_desktop_action_to_mobile_conversion": mapped_delivery_df["src_total_unknown_desktop_action_to_mobile_conversion"],
                                        "src_total_unknown_desktop_action_to_tablet_conversion": mapped_delivery_df["src_total_unknown_desktop_action_to_tablet_conversion"],
                                        "src_total_unknown_mobile_action_to_desktop_conversion": mapped_delivery_df["src_total_unknown_mobile_action_to_desktop_conversion"],
                                        "src_total_unknown_mobile_action_to_mobile_conversion": mapped_delivery_df["src_total_unknown_mobile_action_to_mobile_conversion"],
                                        "src_total_unknown_mobile_action_to_tablet_conversion": mapped_delivery_df["src_total_unknown_mobile_action_to_tablet_conversion"],
                                        "src_total_unknown_tablet_action_to_desktop_conversion": mapped_delivery_df["src_total_unknown_tablet_action_to_desktop_conversion"],
                                        "src_total_unknown_tablet_action_to_mobile_conversion": mapped_delivery_df["src_total_unknown_tablet_action_to_mobile_conversion"],
                                        "src_total_unknown_tablet_action_to_tablet_conversion": mapped_delivery_df["src_total_unknown_tablet_action_to_tablet_conversion"],
                                        "src_total_video_3sec_views": mapped_delivery_df["src_total_video_3sec_views"],
                                        "src_total_video_avg_watchtime_in_second": mapped_delivery_df["src_total_video_avg_watchtime_in_second"],
                                        "src_total_video_mrc_views": mapped_delivery_df["src_total_video_mrc_views"],
                                        "src_total_video_p0_combined": mapped_delivery_df["src_total_video_p0_combined"],
                                        "src_total_video_p100_complete": mapped_delivery_df["src_total_video_p100_complete"],
                                        "src_total_video_p25_combined": mapped_delivery_df["src_total_video_p25_combined"],
                                        "src_total_video_p50_combined": mapped_delivery_df["src_total_video_p50_combined"],
                                        "src_total_video_p75_combined": mapped_delivery_df["src_total_video_p75_combined"],
                                        "src_total_video_p95_combined": mapped_delivery_df["src_total_video_p95_combined"],
                                        "src_total_view_add_to_cart": mapped_delivery_df["src_total_view_add_to_cart"],
                                        "src_total_view_add_to_cart_quantity": mapped_delivery_df["src_total_view_add_to_cart_quantity"],
                                        "src_total_view_add_to_cart_value_in_micro_dollar": mapped_delivery_df["src_total_view_add_to_cart_value_in_micro_dollar"],
                                        "src_total_view_app_install": mapped_delivery_df["src_total_view_app_install"],
                                        "src_total_view_app_install_value_in_micro_dollar": mapped_delivery_df["src_total_view_app_install_value_in_micro_dollar"],
                                        "src_total_view_category": mapped_delivery_df["src_total_view_category"],
                                        "src_total_view_category_desktop_action_to_desktop_conversion": mapped_delivery_df["src_total_view_category_desktop_action_to_desktop_conversion"],
                                        "src_total_view_category_desktop_action_to_mobile_conversion": mapped_delivery_df["src_total_view_category_desktop_action_to_mobile_conversion"],
                                        "src_total_view_category_desktop_action_to_tablet_conversion": mapped_delivery_df["src_total_view_category_desktop_action_to_tablet_conversion"],
                                        "src_total_view_category_mobile_action_to_desktop_conversion": mapped_delivery_df["src_total_view_category_mobile_action_to_desktop_conversion"],
                                        "src_total_view_category_mobile_action_to_mobile_conversion": mapped_delivery_df["src_total_view_category_mobile_action_to_mobile_conversion"],
                                        "src_total_view_category_mobile_action_to_tablet_conversion": mapped_delivery_df["src_total_view_category_mobile_action_to_tablet_conversion"],
                                        "src_total_view_category_tablet_action_to_desktop_conversion": mapped_delivery_df["src_total_view_category_tablet_action_to_desktop_conversion"],
                                        "src_total_view_category_tablet_action_to_mobile_conversion": mapped_delivery_df["src_total_view_category_tablet_action_to_mobile_conversion"],
                                        "src_total_view_category_tablet_action_to_tablet_conversion": mapped_delivery_df["src_total_view_category_tablet_action_to_tablet_conversion"],
                                        "src_total_view_category_value_in_micro_dollar": mapped_delivery_df["src_total_view_category_value_in_micro_dollar"],
                                        "src_total_view_checkout": mapped_delivery_df["src_total_view_checkout"],
                                        "src_total_view_checkout_quantity": mapped_delivery_df["src_total_view_checkout_quantity"],
                                        "src_total_view_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_view_checkout_value_in_micro_dollar"],
                                        "src_total_view_custom": mapped_delivery_df["src_total_view_custom"],
                                        "src_total_view_custom_quantity": mapped_delivery_df["src_total_view_custom_quantity"],
                                        "src_total_view_custom_value_in_micro_dollar": mapped_delivery_df["src_total_view_custom_value_in_micro_dollar"],
                                        "src_total_view_lead": mapped_delivery_df["src_total_view_lead"],
                                        "src_total_view_lead_quantity": mapped_delivery_df["src_total_view_lead_quantity"],
                                        "src_total_view_lead_value_in_micro_dollar": mapped_delivery_df["src_total_view_lead_value_in_micro_dollar"],
                                        "src_total_view_page_visit": mapped_delivery_df["src_total_view_page_visit"],
                                        "src_total_view_page_visit_quantity": mapped_delivery_df["src_total_view_page_visit_quantity"],
                                        "src_total_view_page_visit_value_in_micro_dollar": mapped_delivery_df["src_total_view_page_visit_value_in_micro_dollar"],
                                        "src_total_view_search": mapped_delivery_df["src_total_view_search"],
                                        "src_total_view_search_quantity": mapped_delivery_df["src_total_view_search_quantity"],
                                        "src_total_view_search_value_in_micro_dollar": mapped_delivery_df["src_total_view_search_value_in_micro_dollar"],
                                        "src_total_view_signup": mapped_delivery_df["src_total_view_signup"],
                                        "src_total_view_signup_quantity": mapped_delivery_df["src_total_view_signup_quantity"],
                                        "src_total_view_signup_value_in_micro_dollar": mapped_delivery_df["src_total_view_signup_value_in_micro_dollar"],
                                        "src_total_view_unknown": mapped_delivery_df["src_total_view_unknown"],
                                        "src_total_view_unknown_quantity": mapped_delivery_df["src_total_view_unknown_quantity"],
                                        "src_total_view_unknown_value_in_micro_dollar": mapped_delivery_df["src_total_view_unknown_value_in_micro_dollar"],
                                        "src_total_view_view_category": mapped_delivery_df["src_total_view_view_category"],
                                        "src_total_view_view_category_quantity": mapped_delivery_df["src_total_view_view_category_quantity"],
                                        "src_total_view_view_category_value_in_micro_dollar": mapped_delivery_df["src_total_view_view_category_value_in_micro_dollar"],
                                        "src_total_view_watch_video": mapped_delivery_df["src_total_view_watch_video"],
                                        "src_total_view_watch_video_quantity": mapped_delivery_df["src_total_view_watch_video_quantity"],
                                        "src_total_view_watch_video_value_in_micro_dollar": mapped_delivery_df["src_total_view_watch_video_value_in_micro_dollar"],
                                        "src_total_watch_video": mapped_delivery_df["src_total_watch_video"],
                                        "src_total_watch_video_desktop_action_to_desktop_conversion": mapped_delivery_df["src_total_watch_video_desktop_action_to_desktop_conversion"],
                                        "src_total_watch_video_desktop_action_to_mobile_conversion": mapped_delivery_df["src_total_watch_video_desktop_action_to_mobile_conversion"],
                                        "src_total_watch_video_desktop_action_to_tablet_conversion": mapped_delivery_df["src_total_watch_video_desktop_action_to_tablet_conversion"],
                                        "src_total_watch_video_mobile_action_to_desktop_conversion": mapped_delivery_df["src_total_watch_video_mobile_action_to_desktop_conversion"],
                                        "src_total_watch_video_mobile_action_to_mobile_conversion": mapped_delivery_df["src_total_watch_video_mobile_action_to_mobile_conversion"],
                                        "src_total_watch_video_mobile_action_to_tablet_conversion": mapped_delivery_df["src_total_watch_video_mobile_action_to_tablet_conversion"],
                                        "src_total_watch_video_tablet_action_to_desktop_conversion": mapped_delivery_df["src_total_watch_video_tablet_action_to_desktop_conversion"],
                                        "src_total_watch_video_tablet_action_to_mobile_conversion": mapped_delivery_df["src_total_watch_video_tablet_action_to_mobile_conversion"],
                                        "src_total_watch_video_tablet_action_to_tablet_conversion": mapped_delivery_df["src_total_watch_video_tablet_action_to_tablet_conversion"],
                                        "src_total_watch_video_value_in_micro_dollar": mapped_delivery_df["src_total_watch_video_value_in_micro_dollar"],
                                        "src_total_web_add_to_cart": mapped_delivery_df["src_total_web_add_to_cart"],
                                        "src_total_web_add_to_cart_value_in_micro_dollar": mapped_delivery_df["src_total_web_add_to_cart_value_in_micro_dollar"],
                                        "src_total_web_checkout": mapped_delivery_df["src_total_web_checkout"],
                                        "src_total_web_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_web_checkout_value_in_micro_dollar"],
                                        "src_total_web_click_add_to_cart": mapped_delivery_df["src_total_web_click_add_to_cart"],
                                        "src_total_web_click_add_to_cart_value_in_micro_dollar": mapped_delivery_df["src_total_web_click_add_to_cart_value_in_micro_dollar"],
                                        "src_total_web_click_checkout": mapped_delivery_df["src_total_web_click_checkout"],
                                        "src_total_web_click_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_web_click_checkout_value_in_micro_dollar"],
                                        "src_total_web_click_custom": mapped_delivery_df["src_total_web_click_custom"],
                                        "src_total_web_click_custom_value_in_micro_dollar": mapped_delivery_df["src_total_web_click_custom_value_in_micro_dollar"],
                                        "src_total_web_click_lead": mapped_delivery_df["src_total_web_click_lead"],
                                        "src_total_web_click_lead_value_in_micro_dollar": mapped_delivery_df["src_total_web_click_lead_value_in_micro_dollar"],
                                        "src_total_web_click_page_visit": mapped_delivery_df["src_total_web_click_page_visit"],
                                        "src_total_web_click_page_visit_value_in_micro_dollar": mapped_delivery_df["src_total_web_click_page_visit_value_in_micro_dollar"],
                                        "src_total_web_click_search": mapped_delivery_df["src_total_web_click_search"],
                                        "src_total_web_click_search_value_in_micro_dollar": mapped_delivery_df["src_total_web_click_search_value_in_micro_dollar"],
                                        "src_total_web_click_signup": mapped_delivery_df["src_total_web_click_signup"],
                                        "src_total_web_click_signup_value_in_micro_dollar": mapped_delivery_df["src_total_web_click_signup_value_in_micro_dollar"],
                                        "src_total_web_click_unknown": mapped_delivery_df["src_total_web_click_unknown"],
                                        "src_total_web_click_unknown_value_in_micro_dollar": mapped_delivery_df["src_total_web_click_unknown_value_in_micro_dollar"],
                                        "src_total_web_click_view_category": mapped_delivery_df["src_total_web_click_view_category"],
                                        "src_total_web_click_view_category_value_in_micro_dollar": mapped_delivery_df["src_total_web_click_view_category_value_in_micro_dollar"],
                                        "src_total_web_click_watch_video": mapped_delivery_df["src_total_web_click_watch_video"],
                                        "src_total_web_click_watch_video_value_in_micro_dollar": mapped_delivery_df["src_total_web_click_watch_video_value_in_micro_dollar"],
                                        "src_total_web_custom": mapped_delivery_df["src_total_web_custom"],
                                        "src_total_web_custom_value_in_micro_dollar": mapped_delivery_df["src_total_web_custom_value_in_micro_dollar"],
                                        "src_total_web_engagement_add_to_cart": mapped_delivery_df["src_total_web_engagement_add_to_cart"],
                                        "src_total_web_engagement_add_to_cart_value_in_micro_dollar": mapped_delivery_df["src_total_web_engagement_add_to_cart_value_in_micro_dollar"],
                                        "src_total_web_engagement_checkout": mapped_delivery_df["src_total_web_engagement_checkout"],
                                        "src_total_web_engagement_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_web_engagement_checkout_value_in_micro_dollar"],
                                        "src_total_web_engagement_custom": mapped_delivery_df["src_total_web_engagement_custom"],
                                        "src_total_web_engagement_custom_value_in_micro_dollar": mapped_delivery_df["src_total_web_engagement_custom_value_in_micro_dollar"],
                                        "src_total_web_engagement_lead": mapped_delivery_df["src_total_web_engagement_lead"],
                                        "src_total_web_engagement_lead_value_in_micro_dollar": mapped_delivery_df["src_total_web_engagement_lead_value_in_micro_dollar"],
                                        "src_total_web_engagement_page_visit": mapped_delivery_df["src_total_web_engagement_page_visit"],
                                        "src_total_web_engagement_page_visit_value_in_micro_dollar": mapped_delivery_df["src_total_web_engagement_page_visit_value_in_micro_dollar"],
                                        "src_total_web_engagement_search": mapped_delivery_df["src_total_web_engagement_search"],
                                        "src_total_web_engagement_search_value_in_micro_dollar": mapped_delivery_df["src_total_web_engagement_search_value_in_micro_dollar"],
                                        "src_total_web_engagement_signup": mapped_delivery_df["src_total_web_engagement_signup"],
                                        "src_total_web_engagement_signup_value_in_micro_dollar": mapped_delivery_df["src_total_web_engagement_signup_value_in_micro_dollar"],
                                        "src_total_web_engagement_unknown": mapped_delivery_df["src_total_web_engagement_unknown"],
                                        "src_total_web_engagement_unknown_value_in_micro_dollar": mapped_delivery_df["src_total_web_engagement_unknown_value_in_micro_dollar"],
                                        "src_total_web_engagement_view_category": mapped_delivery_df["src_total_web_engagement_view_category"],
                                        "src_total_web_engagement_view_category_value_in_micro_dollar": mapped_delivery_df["src_total_web_engagement_view_category_value_in_micro_dollar"],
                                        "src_total_web_engagement_watch_video": mapped_delivery_df["src_total_web_engagement_watch_video"],
                                        "src_total_web_engagement_watch_video_value_in_micro_dollar": mapped_delivery_df["src_total_web_engagement_watch_video_value_in_micro_dollar"],
                                        "src_total_web_lead": mapped_delivery_df["src_total_web_lead"],
                                        "src_total_web_lead_value_in_micro_dollar": mapped_delivery_df["src_total_web_lead_value_in_micro_dollar"],
                                        "src_total_web_page_visit": mapped_delivery_df["src_total_web_page_visit"],
                                        "src_total_web_page_visit_value_in_micro_dollar": mapped_delivery_df["src_total_web_page_visit_value_in_micro_dollar"],
                                        "src_total_web_search": mapped_delivery_df["src_total_web_search"],
                                        "src_total_web_search_value_in_micro_dollar": mapped_delivery_df["src_total_web_search_value_in_micro_dollar"],
                                        "src_total_web_sessions": mapped_delivery_df["src_total_web_sessions"],
                                        "src_total_web_signup": mapped_delivery_df["src_total_web_signup"],
                                        "src_total_web_signup_value_in_micro_dollar": mapped_delivery_df["src_total_web_signup_value_in_micro_dollar"],
                                        "src_total_web_unknown": mapped_delivery_df["src_total_web_unknown"],
                                        "src_total_web_unknown_value_in_micro_dollar": mapped_delivery_df["src_total_web_unknown_value_in_micro_dollar"],
                                        "src_total_web_view_add_to_cart": mapped_delivery_df["src_total_web_view_add_to_cart"],
                                        "src_total_web_view_add_to_cart_value_in_micro_dollar": mapped_delivery_df["src_total_web_view_add_to_cart_value_in_micro_dollar"],
                                        "src_total_web_view_category": mapped_delivery_df["src_total_web_view_category"],
                                        "src_total_web_view_category_value_in_micro_dollar": mapped_delivery_df["src_total_web_view_category_value_in_micro_dollar"],
                                        "src_total_web_view_checkout": mapped_delivery_df["src_total_web_view_checkout"],
                                        "src_total_web_view_checkout_value_in_micro_dollar": mapped_delivery_df["src_total_web_view_checkout_value_in_micro_dollar"],
                                        "src_total_web_view_custom": mapped_delivery_df["src_total_web_view_custom"],
                                        "src_total_web_view_custom_value_in_micro_dollar": mapped_delivery_df["src_total_web_view_custom_value_in_micro_dollar"],
                                        "src_total_web_view_lead": mapped_delivery_df["src_total_web_view_lead"],
                                        "src_total_web_view_lead_value_in_micro_dollar": mapped_delivery_df["src_total_web_view_lead_value_in_micro_dollar"],
                                        "src_total_web_view_page_visit": mapped_delivery_df["src_total_web_view_page_visit"],
                                        "src_total_web_view_page_visit_value_in_micro_dollar": mapped_delivery_df["src_total_web_view_page_visit_value_in_micro_dollar"],
                                        "src_total_web_view_search": mapped_delivery_df["src_total_web_view_search"],
                                        "src_total_web_view_search_value_in_micro_dollar": mapped_delivery_df["src_total_web_view_search_value_in_micro_dollar"],
                                        "src_total_web_view_signup": mapped_delivery_df["src_total_web_view_signup"],
                                        "src_total_web_view_signup_value_in_micro_dollar": mapped_delivery_df["src_total_web_view_signup_value_in_micro_dollar"],
                                        "src_total_web_view_unknown": mapped_delivery_df["src_total_web_view_unknown"],
                                        "src_total_web_view_unknown_value_in_micro_dollar": mapped_delivery_df["src_total_web_view_unknown_value_in_micro_dollar"],
                                        "src_total_web_view_view_category": mapped_delivery_df["src_total_web_view_view_category"],
                                        "src_total_web_view_view_category_value_in_micro_dollar": mapped_delivery_df["src_total_web_view_view_category_value_in_micro_dollar"],
                                        "src_total_web_view_watch_video": mapped_delivery_df["src_total_web_view_watch_video"],
                                        "src_total_web_view_watch_video_value_in_micro_dollar": mapped_delivery_df["src_total_web_view_watch_video_value_in_micro_dollar"],
                                        "src_total_web_watch_video": mapped_delivery_df["src_total_web_watch_video"],
                                        "src_total_web_watch_video_value_in_micro_dollar": mapped_delivery_df["src_total_web_watch_video_value_in_micro_dollar"],
                                        "src_video_3sec_views_1": mapped_delivery_df["src_video_3sec_views_1"],
                                        "src_video_3sec_views_2": mapped_delivery_df["src_video_3sec_views_2"],
                                        "src_video_avg_watchtime_in_second_1": mapped_delivery_df["src_video_avg_watchtime_in_second_1"],
                                        "src_video_avg_watchtime_in_second_2": mapped_delivery_df["src_video_avg_watchtime_in_second_2"],
                                        "src_video_length": mapped_delivery_df["src_video_length"],
                                        "src_video_mrc_views_1": mapped_delivery_df["src_video_mrc_views_1"],
                                        "src_video_mrc_views_2": mapped_delivery_df["src_video_mrc_views_2"],
                                        "src_video_p0_combined_1": mapped_delivery_df["src_video_p0_combined_1"],
                                        "src_video_p0_combined_2": mapped_delivery_df["src_video_p0_combined_2"],
                                        "src_video_p100_complete_1": mapped_delivery_df["src_video_p100_complete_1"],
                                        "src_video_p100_complete_2": mapped_delivery_df["src_video_p100_complete_2"],
                                        "src_video_p25_combined_1": mapped_delivery_df["src_video_p25_combined_1"],
                                        "src_video_p25_combined_2": mapped_delivery_df["src_video_p25_combined_2"],
                                        "src_video_p50_combined_1": mapped_delivery_df["src_video_p50_combined_1"],
                                        "src_video_p50_combined_2": mapped_delivery_df["src_video_p50_combined_2"],
                                        "src_video_p75_combined_1": mapped_delivery_df["src_video_p75_combined_1"],
                                        "src_video_p75_combined_2": mapped_delivery_df["src_video_p75_combined_2"],
                                        "src_video_p95_combined_1": mapped_delivery_df["src_video_p95_combined_1"],
                                        "src_video_p95_combined_2": mapped_delivery_df["src_video_p95_combined_2"],
                                        "src_web_sessions_1": mapped_delivery_df["src_web_sessions_1"],
                                        "src_web_sessions_2": mapped_delivery_df["src_web_sessions_2"],
                                        "pinterest_account_id": mapped_delivery_df["pinterest_account_id"],
                                        "line_item_lineage_id": mapped_delivery_df["line_item_lineage_id"],
                                        "agency_id": mapped_delivery_df["agency_id"],
                                        "pinterest_campaign_id": mapped_delivery_df["pinterest_campaign_id"],
                                        "pinterest_ad_group_id": mapped_delivery_df["pinterest_ad_group_id"],
                                        "delivered_on_date": mapped_delivery_df["delivered_on_date"],
                                        "delivery_data_representation_id": mapped_delivery_df["delivery_data_representation_id"],
                                        "pinterest_ad_group_wid": mapped_delivery_df["pinterest_ad_group_wid"],
                                        "pinterest_campaign_wid": mapped_delivery_df["pinterest_campaign_wid"],
                                        "integration_source_code": mapped_delivery_df["integration_source_code"],
                                        "delivery_wid": mapped_delivery_df["delivery_wid"],
                                        "data_as_of_ts": mapped_delivery_df["data_as_of_ts"],
                                        "file_name": mapped_delivery_df["file_name"],
                                        "file_row_number": mapped_delivery_df["file_row_number"],
                                        "date_wid": mapped_delivery_df["date_wid"],
                                        "created_batch_id": mapped_delivery_df["created_batch_id"],
                                        "created_ts": mapped_delivery_df["created_ts"],
                                        "modified_batch_id": mapped_delivery_df["modified_batch_id"],
                                        "modified_ts": mapped_delivery_df["modified_ts"]
                                    })])

    def get_all_metrics(self, df, batch_id):
        final_df = (df
                    .withColumnRenamed("external_campaign_id", "pinterest_campaign_id")
                    .withColumnRenamed("external_ad_group_id", "pinterest_ad_group_id")
                    .withColumn("pinterest_campaign_wid", F.sha1(F.concat(F.col("integration_source_code"),
                                                                       F.col("agency_id"),
                                                                       F.col("pinterest_campaign_id"))))
                    .withColumn("pinterest_ad_group_wid", F.sha1(F.concat(F.col("integration_source_code"),
                                                                     F.col("agency_id"),
                                                                     F.col("pinterest_ad_group_id"),
                                                                     F.col("pinterest_campaign_id"))))
                    .withColumn("delivery_wid", F.sha1(F.concat(F.col("integration_source_code"),
                                                                F.col("agency_id"),
                                                                F.col("line_item_lineage_id"),
                                                                F.col("delivery_data_representation_id"),
                                                                F.col("pinterest_ad_group_id"),
                                                                F.col("pinterest_campaign_id"),
                                                                F.col("delivered_on_date"))))
                    .withColumn("date_wid", F.to_char("delivered_on_date", 'YYYYMMDD').cast(IntegerType()))
                    .withColumn("created_batch_id", F.lit(batch_id))
                    .withColumn("created_ts", F.current_timestamp())
                    .withColumn("modified_batch_id", F.lit(batch_id))
                    .withColumn("modified_ts", F.current_timestamp())
                    .withColumnRenamed("external_account_id", "pinterest_account_id")
                    .withColumnRenamed("file_created_ts", "data_as_of_ts")
                    .withColumnRenamed("advertiser_id", "pinterest_advertiser_id")
                    .withColumnRenamed("order_line_id", "pinterest_order_line_id")
                    .select(all_col_names))
        return final_df

    def get_raw_delivery_w_src_col(self, raw_delivery_df):
        raw_delivery_mod_df = (raw_delivery_df
                               .drop("created_batch_id", "created_ts", "modified_batch_id", "modified_ts"))

        all_raw_del_col_names = [x.lower() for x in raw_delivery_mod_df.columns]
        columns_to_rename_list = [x for x in all_raw_del_col_names if x not in ['integration_source_code',
                                                                                'agency_id',
                                                                                'external_campaign_id',
                                                                                'external_ad_group_id',
                                                                                'external_metro_id',
                                                                                'external_metro_name',
                                                                                'delivered_on_date',
                                                                                'external_account_id',
                                                                                'file_created_ts',
                                                                                'file_name',
                                                                                'file_row_number',
                                                                                'advertiser_id',
                                                                                'order_line_id',
                                                                                'order_line_name',
                                                                                'ad_group_status',
                                                                                'campaign_managed_status'
                                                                                ]]

        raw_delivery_w_prefix_df = self.handle_nulls_number_and_strings_cols(self.add_src_prefix(raw_delivery_mod_df,
                                                       columns_to_rename_list))
        return raw_delivery_w_prefix_df

    def process_incr_raw_delivery(self, session, logger, target, get_all_metrics_fn, integration_source_code):
        raw_delivery_stream = ("{0}.{1}.pinterest_lineitem_ad_group_daily_msg_pagl_stream"
                               .format(get_dict_element(self.config, "db_details.third_party.db_name"),
                                       get_dict_element(self.config, "db_details.third_party.schema_name")))

        incr_raw_delivery_df = (session.sql("select * from {0}".format(raw_delivery_stream))
                                .filter(F.col("METADATA$ACTION") == 'INSERT'))

        incr_raw_delivery_w_prefix_df = self.get_raw_delivery_w_src_col(incr_raw_delivery_df)

        line_item_tracker_name = ("{0}.{1}.brg_delivery_mapping_third_party"
                                  .format(get_dict_element(self.config, "db_details.basis_platform.db_name"),
                                          get_dict_element(self.config, "db_details.basis_platform.schema_name")))

        line_item_tracker_df = (session.sql("select * from {0}".format(line_item_tracker_name))
                                .withColumnRenamed("agency_id", "li_agency_id")
                                .select("line_item_lineage_id",
                                        "line_item_start_date",
                                        "line_item_end_date",
                                        "delivery_data_representation_id",
                                        "delivery_data_mapping_external_id",
                                        "li_agency_id")
                                .filter(F.col("integration_source_code") == F.lit(integration_source_code))
                                )

        mapped_delivery_df = (
            line_item_tracker_df.join(incr_raw_delivery_w_prefix_df,
                                      (line_item_tracker_df["delivery_data_mapping_external_id"] ==
                                       incr_raw_delivery_w_prefix_df["external_campaign_id"]) &
                                      (line_item_tracker_df["li_agency_id"] == incr_raw_delivery_w_prefix_df["agency_id"]))
                                .filter(F.col("delivered_on_date").between(F.col("line_item_start_date"),
                                                                           F.col("line_item_end_date"))))

        final_incr_raw_delivery_df = (get_all_metrics_fn(mapped_delivery_df)
                                      .sort("date_wid",
                                            "line_item_lineage_id",
                                            "delivery_data_representation_id"))
        self.merge_data(session, logger, target, final_incr_raw_delivery_df)

    def save_data(self, session, logger, batch_id):
        logger.info("Merging data to Target Table")

        integration_source_code = 'pinterest_ads'
        var_target_table_name = "FCT_DELIVERY_PINTEREST_LINEITEM_ADGROUP_DAILY_MAPPED"

        line_item_tracker_name = ("{0}.{1}.pinterest_lineitem_ad_group_daily_lm_stream"
                                  .format(get_dict_element(self.config, "db_details.third_party.db_name"),
                                          get_dict_element(self.config, "db_details.third_party.schema_name")))

        li_changes_df = (session.sql("select * from {0}".format(line_item_tracker_name))
                         .filter(F.col("integration_source_code") == F.lit(integration_source_code))
                         .drop("integration_source_code"))

        target_table_name = "{0}.{1}.{2}".format(get_dict_element(self.config, "db_details.third_party.db_name"),
                                                 get_dict_element(self.config, "db_details.third_party.schema_name"),
                                                 var_target_table_name)
        target = session.table(target_table_name)

        raw_delivery_table_name = (
            "{0}.{1}.msg_delivery_pinterest_ad_group_latest"
            .format(get_dict_element(self.config, "db_details.integration.db_name"),
                    get_dict_element(self.config, "db_details.integration.third_party_schema_name")))

        raw_delivery_df = session.sql("select * from {0}".format(raw_delivery_table_name))
        raw_delivery_w_prefix_df = self.get_raw_delivery_w_src_col(raw_delivery_df)

        # # add defaults for src_ columns
        raw_delivery_w_prefix_df = self.handle_nulls_number_and_strings_cols(raw_delivery_w_prefix_df)

        get_all_metrics_fn = partial(self.get_all_metrics, batch_id=batch_id)

        self.process_insert_event(li_changes_df,
                                  raw_delivery_w_prefix_df,
                                  target,
                                  target_table_name,
                                  get_all_metrics_fn)

        self.process_update_event(li_changes_df,
                                  raw_delivery_w_prefix_df,
                                  target,
                                  target_table_name,
                                  get_all_metrics_fn)

        self.process_delete_event(li_changes_df,
                                  target)

        self.process_incr_raw_delivery(session,
                                       logger,
                                       target,
                                       get_all_metrics_fn,
                                       integration_source_code)

        reload_stream_name = ("{0}.{1}.PINTEREST_LINEITEM_AD_GROUP_DAILY_RID_STREAM"
                              .format(get_dict_element(self.config, "db_details.third_party.db_name"),
                                      get_dict_element(self.config, "db_details.third_party.schema_name")))

        self.reload(session,
                    logger,
                    raw_delivery_w_prefix_df,
                    get_all_metrics_fn,
                    target,
                    var_target_table_name,
                    target_table_name,
                    reload_stream_name,
                    integration_source_code)
